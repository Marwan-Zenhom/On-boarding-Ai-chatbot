{"ast":null,"code":"import _objectSpread from\"/workspace/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useCallback,useMemo}from'react';import{Plus,ArrowUp,User,Bot,Sun,Moon,Edit3,Trash2,Search,Copy,Mic,MicOff,Heart,Archive,Sidebar,ThumbsUp,ThumbsDown,RotateCcw,X,Check,Upload,FileText,Paperclip,MoreHorizontal,Square}from'lucide-react';import apiService from'./services/apiService';// --- Custom Hooks ---\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const useLocalStorage=(key,initialValue)=>{const[storedValue,setStoredValue]=useState(()=>{try{const item=window.localStorage.getItem(key);return item?JSON.parse(item):initialValue;}catch(error){return initialValue;}});const setValue=value=>{try{setStoredValue(value);window.localStorage.setItem(key,JSON.stringify(value));}catch(error){console.error('Error saving to localStorage:',error);}};return[storedValue,setValue];};// --- File Upload Component ---\nconst FileUpload=_ref=>{let{onFileSelect,acceptedTypes=\".pdf,.docx,.txt,.csv,.json,.png,.jpg,.jpeg\"}=_ref;const[isDragging,setIsDragging]=useState(false);const fileInputRef=useRef(null);const handleDrop=e=>{e.preventDefault();setIsDragging(false);const files=Array.from(e.dataTransfer.files);onFileSelect(files);};const handleDragOver=e=>{e.preventDefault();setIsDragging(true);};const handleDragLeave=()=>{setIsDragging(false);};const handleFileSelect=e=>{const files=Array.from(e.target.files);onFileSelect(files);};return/*#__PURE__*/_jsxs(\"div\",{className:\"file-upload-area \".concat(isDragging?'dragging':''),onDrop:handleDrop,onDragOver:handleDragOver,onDragLeave:handleDragLeave,onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",multiple:true,accept:acceptedTypes,onChange:handleFileSelect,style:{display:'none'}}),/*#__PURE__*/_jsx(Upload,{className:\"icon\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-text\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"upload-primary\",children:\"Drop files here or click to upload\"}),/*#__PURE__*/_jsx(\"span\",{className:\"upload-secondary\",children:\"Supports PDF, DOCX, TXT, CSV, JSON, Images\"})]})]});};// --- Archived Conversations Modal ---\nconst ArchivedConversationsModal=_ref2=>{let{isOpen,onClose,conversations,onViewChat,onUnarchive,onDelete}=_ref2;if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content archived-modal\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Archived Chats\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"modal-close\",children:/*#__PURE__*/_jsx(X,{className:\"icon\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"archived-modal-content\",children:conversations.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(Archive,{className:\"empty-icon\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No archived conversations\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Conversations you archive will appear here\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"archived-table\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"archived-table-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"archived-table-col-name\",children:\"Name\"}),/*#__PURE__*/_jsx(\"div\",{className:\"archived-table-col-date\",children:\"Date created\"}),/*#__PURE__*/_jsx(\"div\",{className:\"archived-table-col-actions\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"archived-table-body\",children:conversations.map(conv=>/*#__PURE__*/_jsxs(\"div\",{className:\"archived-table-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"archived-table-col-name\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>onViewChat(conv),className:\"archived-chat-name\",title:\"Click to view conversation\",children:conv.title})}),/*#__PURE__*/_jsx(\"div\",{className:\"archived-table-col-date\",children:new Date(conv.createdAt).toLocaleDateString()}),/*#__PURE__*/_jsxs(\"div\",{className:\"archived-table-col-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>onUnarchive(conv.id),className:\"archived-icon-btn\",title:\"Unarchive conversation\",children:/*#__PURE__*/_jsx(Archive,{className:\"icon-sm\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onDelete(conv.id),className:\"archived-icon-btn danger\",title:\"Delete conversation\",children:/*#__PURE__*/_jsx(Trash2,{className:\"icon-sm\"})})]})]},conv.id))})]})})]})});};// --- Conversation Dropdown Component ---\nconst ConversationDropdown=_ref3=>{let{conversation,isOpen,onClose,onFavourite,onArchive,onDelete,onRename}=_ref3;if(!isOpen)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();onRename();onClose();},className:\"dropdown-item\",children:[/*#__PURE__*/_jsx(Edit3,{className:\"icon-sm\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Rename\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();onFavourite();onClose();},className:\"dropdown-item\",children:[/*#__PURE__*/_jsx(Heart,{className:\"icon-sm\"}),/*#__PURE__*/_jsx(\"span\",{children:conversation.isFavourite?'Remove from favourites':'Add to favourites'})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();onArchive();onClose();},className:\"dropdown-item\",children:[/*#__PURE__*/_jsx(Archive,{className:\"icon-sm\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Archive\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();onDelete();onClose();},className:\"dropdown-item danger\",children:[/*#__PURE__*/_jsx(Trash2,{className:\"icon-sm\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Delete\"})]})]});};// --- Utility Components ---\nconst SkeletonLoader=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"skeleton-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"skeleton skeleton-avatar\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"skeleton-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"skeleton skeleton-line long\"}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton skeleton-line medium\"}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton skeleton-line short\"})]})]});const Toast=_ref4=>{let{message,type,onClose}=_ref4;return/*#__PURE__*/_jsxs(\"div\",{className:\"toast toast-\".concat(type),children:[/*#__PURE__*/_jsx(\"span\",{children:message}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"toast-close\",children:/*#__PURE__*/_jsx(X,{className:\"icon-sm\"})})]});};const MessageActions=_ref5=>{let{message,onCopy,onEdit,onReact,onRegenerate}=_ref5;return/*#__PURE__*/_jsxs(\"div\",{className:\"message-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"action-btn\",onClick:()=>onCopy(message.content),title:\"Copy message\",children:/*#__PURE__*/_jsx(Copy,{className:\"icon-sm\"})}),message.role==='assistant'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"action-btn\",onClick:()=>onReact(message.id,'like'),title:\"Good response\",children:/*#__PURE__*/_jsx(ThumbsUp,{className:\"icon-sm\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn\",onClick:()=>onReact(message.id,'dislike'),title:\"Poor response\",children:/*#__PURE__*/_jsx(ThumbsDown,{className:\"icon-sm\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn\",onClick:()=>onRegenerate(message.id),title:\"Regenerate\",children:/*#__PURE__*/_jsx(RotateCcw,{className:\"icon-sm\"})})]}),message.role==='user'&&/*#__PURE__*/_jsx(\"button\",{className:\"action-btn\",onClick:()=>onEdit(message.id),title:\"Edit message\",children:/*#__PURE__*/_jsx(Edit3,{className:\"icon-sm\"})})]});};// --- Main App Component ---\nexport default function App(){var _pastConversations$fi,_supportedLanguages$f,_supportedLanguages$f2,_supportedLanguages$f3;// --- State Management ---\nconst[pastConversations,setPastConversations]=useState([]);const[conversationsLoading,setConversationsLoading]=useState(true);const[messages,setMessages]=useState([]);const[input,setInput]=useState('');const[isLoading,setIsLoading]=useState(false);const[currentConversationId,setCurrentConversationId]=useState(null);const[isSidebarCollapsed,setIsSidebarCollapsed]=useState(false);const[isSidebarOpen,setIsSidebarOpen]=useState(false);const[isSidebarHidden,setIsSidebarHidden]=useState(true);const[isMobile,setIsMobile]=useState(window.innerWidth<=768);const[isDarkMode,setIsDarkMode]=useLocalStorage('darkMode',true);const[searchQuery,setSearchQuery]=useState('');const[isSearchFocused,setIsSearchFocused]=useState(false);const[isRecording,setIsRecording]=useState(false);const[recognition,setRecognition]=useState(null);const[multiRecognitions,setMultiRecognitions]=useState([]);const[speechLanguage,setSpeechLanguage]=useState(()=>{// Try to match browser language with supported languages\nconst browserLang=navigator.language||'en-US';const supportedCodes=['en-US','en-GB','de-DE','fr-FR','es-ES','it-IT','pt-PT','nl-NL','ru-RU','ja-JP','ko-KR','zh-CN','ar-SA'];return supportedCodes.includes(browserLang)?browserLang:'en-US';});const[showLanguageSelector,setShowLanguageSelector]=useState(false);const[autoDetectLanguage,setAutoDetectLanguage]=useState(true);const[detectedLanguage,setDetectedLanguage]=useState(null);const[toast,setToast]=useState(null);const[editingMessageId,setEditingMessageId]=useState(null);const[editingText,setEditingText]=useState('');const[uploadedFiles,setUploadedFiles]=useState([]);const[showFileUpload,setShowFileUpload]=useState(false);const[showScrollToBottom,setShowScrollToBottom]=useState(false);const[typingMessageId,setTypingMessageId]=useState(null);const[displayedContent,setDisplayedContent]=useState({});const[openDropdownId,setOpenDropdownId]=useState(null);const[renamingConversationId,setRenamingConversationId]=useState(null);const[renamingText,setRenamingText]=useState('');const[showArchivedModal,setShowArchivedModal]=useState(false);const[conversationFilter,setConversationFilter]=useState('all');const[isGenerating,setIsGenerating]=useState(false);const[generationTimeoutId,setGenerationTimeoutId]=useState(null);const[typingTimeoutIds,setTypingTimeoutIds]=useState([]);// Load conversations on app start\nuseEffect(()=>{const loadConversations=async()=>{try{setConversationsLoading(true);const response=await apiService.getConversations();if(response.success){setPastConversations(response.conversations);}}catch(error){console.error('Failed to load conversations:',error);}finally{setConversationsLoading(false);}};loadConversations();},[]);const chatEndRef=useRef(null);const inputRef=useRef(null);const chatContainerRef=useRef(null);// Supported languages for speech recognition\nconst supportedLanguages=[{code:'en-US',name:'English (US)',flag:'ðŸ‡ºðŸ‡¸'},{code:'en-GB',name:'English (UK)',flag:'ðŸ‡¬ðŸ‡§'},{code:'de-DE',name:'German',flag:'ðŸ‡©ðŸ‡ª'},{code:'fr-FR',name:'French',flag:'ðŸ‡«ðŸ‡·'},{code:'es-ES',name:'Spanish',flag:'ðŸ‡ªðŸ‡¸'},{code:'it-IT',name:'Italian',flag:'ðŸ‡®ðŸ‡¹'},{code:'pt-PT',name:'Portuguese',flag:'ðŸ‡µðŸ‡¹'},{code:'nl-NL',name:'Dutch',flag:'ðŸ‡³ðŸ‡±'},{code:'ru-RU',name:'Russian',flag:'ðŸ‡·ðŸ‡º'},{code:'ja-JP',name:'Japanese',flag:'ðŸ‡¯ðŸ‡µ'},{code:'ko-KR',name:'Korean',flag:'ðŸ‡°ðŸ‡·'},{code:'zh-CN',name:'Chinese (Simplified)',flag:'ðŸ‡¨ðŸ‡³'},{code:'ar-SA',name:'Arabic',flag:'ðŸ‡¸ðŸ‡¦'}];// --- Memoized Values ---\nconst filteredConversations=useMemo(()=>{let filtered=pastConversations.filter(conv=>!conv.is_archived);if(conversationFilter==='favourites'){filtered=filtered.filter(conv=>conv.is_favourite);}if(searchQuery){filtered=filtered.filter(conv=>{var _conv$messages;return conv.title.toLowerCase().includes(searchQuery.toLowerCase())||((_conv$messages=conv.messages)===null||_conv$messages===void 0?void 0:_conv$messages.some(msg=>msg.content.toLowerCase().includes(searchQuery.toLowerCase())));});}return filtered.sort((a,b)=>{if(a.is_favourite&&!b.is_favourite)return-1;if(!a.is_favourite&&b.is_favourite)return 1;return new Date(b.created_at)-new Date(a.created_at);});},[pastConversations,searchQuery,conversationFilter]);const archivedConversations=useMemo(()=>{let archived=pastConversations.filter(conv=>conv.is_archived);if(searchQuery){archived=archived.filter(conv=>{var _conv$messages2;return conv.title.toLowerCase().includes(searchQuery.toLowerCase())||((_conv$messages2=conv.messages)===null||_conv$messages2===void 0?void 0:_conv$messages2.some(msg=>msg.content.toLowerCase().includes(searchQuery.toLowerCase())));});}return archived.sort((a,b)=>new Date(b.created_at)-new Date(a.created_at));},[pastConversations,searchQuery]);const groupConversationsByDate=conversations=>{const now=new Date();const today=new Date(now.getFullYear(),now.getMonth(),now.getDate());const yesterday=new Date(today);yesterday.setDate(yesterday.getDate()-1);const lastWeek=new Date(today);lastWeek.setDate(lastWeek.getDate()-7);const lastMonth=new Date(today);lastMonth.setMonth(lastMonth.getMonth()-1);const groups={today:[],yesterday:[],lastWeek:[],lastMonth:[],older:[]};conversations.forEach(conv=>{const convDate=new Date(conv.created_at);const convDateOnly=new Date(convDate.getFullYear(),convDate.getMonth(),convDate.getDate());if(convDateOnly.getTime()===today.getTime()){groups.today.push(conv);}else if(convDateOnly.getTime()===yesterday.getTime()){groups.yesterday.push(conv);}else if(convDate>=lastWeek){groups.lastWeek.push(conv);}else if(convDate>=lastMonth){groups.lastMonth.push(conv);}else{groups.older.push(conv);}});return groups;};const conversationGroups=useMemo(()=>groupConversationsByDate(filteredConversations),[filteredConversations]);// --- Effects ---\nuseEffect(()=>{var _chatEndRef$current;(_chatEndRef$current=chatEndRef.current)===null||_chatEndRef$current===void 0?void 0:_chatEndRef$current.scrollIntoView({behavior:'smooth'});},[messages]);useEffect(()=>{document.documentElement.setAttribute('data-theme',isDarkMode?'dark':'light');},[isDarkMode]);useEffect(()=>{const handleResize=()=>{const mobile=window.innerWidth<=768;setIsMobile(mobile);if(!mobile&&isSidebarOpen){setIsSidebarOpen(false);}};window.addEventListener('resize',handleResize);return()=>window.removeEventListener('resize',handleResize);},[isSidebarOpen]);useEffect(()=>{const handleClickOutside=event=>{if(isMobile&&isSidebarOpen&&!event.target.closest('.sidebar')&&!event.target.closest('.sidebar-toggle')){setIsSidebarOpen(false);}if(openDropdownId&&!event.target.closest('.conversation-dropdown')&&!event.target.closest('.dropdown-toggle')){setOpenDropdownId(null);}if(showLanguageSelector&&!event.target.closest('.language-selector')&&!event.target.closest('.language-toggle')){setShowLanguageSelector(false);}};document.addEventListener('mousedown',handleClickOutside);document.addEventListener('touchstart',handleClickOutside);return()=>{document.removeEventListener('mousedown',handleClickOutside);document.removeEventListener('touchstart',handleClickOutside);};},[isMobile,isSidebarOpen,openDropdownId,showLanguageSelector]);useEffect(()=>{const chatContainer=chatContainerRef.current;if(!chatContainer)return;const handleScroll=()=>{const{scrollTop,scrollHeight,clientHeight}=chatContainer;const isNearBottom=scrollHeight-scrollTop-clientHeight<100;setShowScrollToBottom(!isNearBottom&&messages.length>0);};chatContainer.addEventListener('scroll',handleScroll);return()=>chatContainer.removeEventListener('scroll',handleScroll);},[messages.length]);// --- Essential Callbacks ---\nconst showToast=useCallback(function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'success';setToast({message,type});setTimeout(()=>setToast(null),3000);},[]);// Initialize speech recognition\nuseEffect(()=>{if('webkitSpeechRecognition'in window||'SpeechRecognition'in window){const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;if(autoDetectLanguage){// Create multiple recognition instances for auto-detection\nconst primaryLanguages=['en-US','de-DE','fr-FR','es-ES','it-IT'];const recognitionInstances=[];primaryLanguages.forEach(langCode=>{const recognitionInstance=new SpeechRecognition();recognitionInstance.continuous=false;recognitionInstance.interimResults=true;recognitionInstance.lang=langCode;recognitionInstance.onresult=event=>{let finalTranscript='';let confidence=0;for(let i=event.resultIndex;i<event.results.length;i++){const result=event.results[i];if(result.isFinal){finalTranscript+=result[0].transcript;confidence=result[0].confidence||0;}}if(finalTranscript&&confidence>0.7){// Stop all recognition instances\nrecognitionInstances.forEach(rec=>{try{rec.stop();}catch(e){}});const detectedLang=supportedLanguages.find(lang=>lang.code===langCode);setDetectedLanguage(langCode);setSpeechLanguage(langCode);setInput(prev=>prev+finalTranscript);setIsRecording(false);showToast(\"Detected \".concat((detectedLang===null||detectedLang===void 0?void 0:detectedLang.name)||langCode,\": \\\"\").concat(finalTranscript.substring(0,30),\"...\\\"\"),'success');}};recognitionInstance.onerror=event=>{if(event.error!=='aborted'&&event.error!=='no-speech'){console.error(\"Speech recognition error (\".concat(langCode,\"):\"),event.error);}};recognitionInstances.push(recognitionInstance);});setMultiRecognitions(recognitionInstances);}else{// Single language recognition (manual selection)\nconst recognitionInstance=new SpeechRecognition();recognitionInstance.continuous=false;recognitionInstance.interimResults=true;recognitionInstance.lang=speechLanguage;recognitionInstance.onstart=()=>{setIsRecording(true);const selectedLanguage=supportedLanguages.find(lang=>lang.code===speechLanguage);showToast(\"Listening in \".concat((selectedLanguage===null||selectedLanguage===void 0?void 0:selectedLanguage.name)||speechLanguage,\"... Speak now\"),'info');};recognitionInstance.onresult=event=>{let finalTranscript='';for(let i=event.resultIndex;i<event.results.length;i++){const transcript=event.results[i][0].transcript;if(event.results[i].isFinal){finalTranscript+=transcript;}}if(finalTranscript){setInput(prev=>prev+finalTranscript);}};recognitionInstance.onend=()=>{setIsRecording(false);};recognitionInstance.onerror=event=>{console.error('Speech recognition error:',event.error);setIsRecording(false);let errorMessage='Speech recognition error';switch(event.error){case'no-speech':errorMessage='No speech detected. Try again.';break;case'not-allowed':errorMessage='Microphone access denied. Please allow microphone access.';break;case'network':errorMessage='Network error. Check your connection.';break;default:errorMessage=\"Speech recognition error: \".concat(event.error);}showToast(errorMessage,'error');};setRecognition(recognitionInstance);}}},[showToast,speechLanguage,supportedLanguages,autoDetectLanguage]);const typeMessage=useCallback((messageId,content)=>{setTypingMessageId(messageId);setDisplayedContent(prev=>_objectSpread(_objectSpread({},prev),{},{[messageId]:''}));let currentIndex=0;const typingSpeed=8;const timeoutIds=[];const typeChar=()=>{if(currentIndex<content.length){setDisplayedContent(prev=>_objectSpread(_objectSpread({},prev),{},{[messageId]:content.slice(0,currentIndex+1)}));currentIndex++;const timeoutId=setTimeout(typeChar,typingSpeed);timeoutIds.push(timeoutId);setTypingTimeoutIds(prev=>[...prev,timeoutId]);}else{setTypingMessageId(null);setDisplayedContent(prev=>_objectSpread(_objectSpread({},prev),{},{[messageId]:content}));setTypingTimeoutIds(prev=>prev.filter(id=>!timeoutIds.includes(id)));setIsGenerating(false);}};typeChar();},[]);const regenerateResponse=useCallback(async messageId=>{const messageIndex=messages.findIndex(msg=>msg.id===messageId);if(messageIndex===-1||messages[messageIndex].role!=='assistant')return;let userMessageIndex=messageIndex-1;while(userMessageIndex>=0&&messages[userMessageIndex].role!=='user'){userMessageIndex--;}if(userMessageIndex===-1)return;const userMessage=messages[userMessageIndex];const messagesUpToUser=messages.slice(0,messageIndex);setMessages(messagesUpToUser);setDisplayedContent(prev=>{const newContent=_objectSpread({},prev);delete newContent[messageId];return newContent;});setIsLoading(true);setIsGenerating(true);showToast('Regenerating response...');try{// Call backend API to regenerate response\nconst response=await apiService.regenerateResponse(currentConversationId,userMessage.id);if(response.success){const newBotResponseId=Date.now().toString();const botMessage={id:newBotResponseId,role:'assistant',content:response.aiResponse.content,timestamp:response.aiResponse.timestamp,reaction:null,isEdited:false,model:response.aiResponse.model};const finalMessages=[...messagesUpToUser,botMessage];setMessages(finalMessages);setTimeout(()=>{typeMessage(newBotResponseId,response.aiResponse.content);},100);showToast('Response regenerated successfully!');}else{throw new Error(response.error||'Failed to regenerate response');}}catch(error){console.error(\"Failed to regenerate response:\",error);showToast('Failed to regenerate response. Please try again.','error');}finally{setIsLoading(false);setIsGenerating(false);setGenerationTimeoutId(null);setTypingMessageId(null);}},[messages,currentConversationId,typeMessage,showToast]);// --- Helper Functions ---\nconst handleNewChat=()=>{var _inputRef$current;setMessages([]);setCurrentConversationId(null);setInput('');setUploadedFiles([]);(_inputRef$current=inputRef.current)===null||_inputRef$current===void 0?void 0:_inputRef$current.focus();if(isMobile){setIsSidebarOpen(false);}};const handleConversationClick=conversation=>{if(conversation.is_archived){showToast('This conversation is archived. Unarchive it first to view.','error');return;}setCurrentConversationId(conversation.id);setMessages(conversation.messages||[]);if(isMobile){setIsSidebarOpen(false);}};const toggleSidebar=()=>{if(isMobile){setIsSidebarOpen(!isSidebarOpen);if(!isSidebarOpen){setIsSidebarHidden(false);}}else{setIsSidebarHidden(!isSidebarHidden);if(isSidebarHidden){setIsSidebarCollapsed(false);}}};const toggleTheme=()=>{setIsDarkMode(!isDarkMode);};const copyToClipboard=text=>{navigator.clipboard.writeText(text).then(()=>{showToast('Copied to clipboard!');});};const handleFileSelect=files=>{const newFiles=files.map(file=>({id:Date.now()+Math.random(),name:file.name,size:file.size,type:file.type,file:file}));setUploadedFiles(prev=>[...prev,...newFiles]);setShowFileUpload(false);showToast(\"\".concat(files.length,\" file(s) uploaded successfully!\"));};const removeFile=fileId=>{setUploadedFiles(prev=>prev.filter(f=>f.id!==fileId));};const scrollToBottom=()=>{var _chatEndRef$current2;(_chatEndRef$current2=chatEndRef.current)===null||_chatEndRef$current2===void 0?void 0:_chatEndRef$current2.scrollIntoView({behavior:'smooth'});};const handleMessageReaction=(messageId,reaction)=>{setMessages(prev=>prev.map(msg=>msg.id===messageId?_objectSpread(_objectSpread({},msg),{},{reaction:msg.reaction===reaction?null:reaction}):msg));showToast(\"Message \".concat(reaction==='like'?'liked':'disliked',\"!\"));};const handleMessageEdit=messageId=>{const message=messages.find(msg=>msg.id===messageId);if(message){setEditingMessageId(messageId);setEditingText(message.content);}};const saveMessageEdit=()=>{setMessages(prev=>prev.map(msg=>msg.id===editingMessageId?_objectSpread(_objectSpread({},msg),{},{content:editingText,isEdited:true}):msg));setEditingMessageId(null);setEditingText('');showToast('Message updated!');};const toggleConversationFavourite=async(convId,e)=>{e.stopPropagation();try{const conversation=pastConversations.find(c=>c.id===convId);await apiService.updateConversation(convId,{is_favourite:!conversation.is_favourite});// Update local state\nsetPastConversations(prev=>prev.map(conv=>conv.id===convId?_objectSpread(_objectSpread({},conv),{},{is_favourite:!conv.is_favourite}):conv));showToast(conversation!==null&&conversation!==void 0&&conversation.is_favourite?'Removed from favourites!':'Added to favourites!');}catch(error){showToast('Failed to update favourite status','error');}};const archiveConversation=async(convId,e)=>{e.stopPropagation();try{const conversation=pastConversations.find(c=>c.id===convId);await apiService.updateConversation(convId,{is_archived:!conversation.is_archived});// Update local state\nsetPastConversations(prev=>prev.map(conv=>conv.id===convId?_objectSpread(_objectSpread({},conv),{},{is_archived:!conv.is_archived}):conv));if(currentConversationId===convId){handleNewChat();}showToast('Conversation archived!');}catch(error){showToast('Failed to archive conversation','error');}};const deleteConversation=async(convId,e)=>{e.stopPropagation();try{await apiService.deleteConversation(convId);// Update local state\nsetPastConversations(prev=>prev.filter(conv=>conv.id!==convId));if(currentConversationId===convId){handleNewChat();}showToast('Conversation deleted!');}catch(error){showToast('Failed to delete conversation','error');}};const toggleDropdown=(convId,e)=>{e.stopPropagation();setOpenDropdownId(openDropdownId===convId?null:convId);};const closeDropdown=()=>{setOpenDropdownId(null);};const startRenaming=convId=>{const conversation=pastConversations.find(c=>c.id===convId);if(conversation){setRenamingConversationId(convId);setRenamingText(conversation.title);}};const saveRename=async()=>{if(renamingText.trim()){try{await apiService.updateConversation(renamingConversationId,{title:renamingText.trim()});// Update local state\nsetPastConversations(prev=>prev.map(conv=>conv.id===renamingConversationId?_objectSpread(_objectSpread({},conv),{},{title:renamingText.trim()}):conv));showToast('Conversation renamed!');}catch(error){showToast('Failed to rename conversation','error');}}setRenamingConversationId(null);setRenamingText('');};const cancelRename=()=>{setRenamingConversationId(null);setRenamingText('');};const viewArchivedChat=conversation=>{setCurrentConversationId(conversation.id);setMessages(conversation.messages||[]);setShowArchivedModal(false);if(isMobile){setIsSidebarOpen(false);setIsSidebarHidden(true);}};const unarchiveConversation=async convId=>{try{await apiService.updateConversation(convId,{is_archived:false});// Update local state\nsetPastConversations(prev=>prev.map(conv=>conv.id===convId?_objectSpread(_objectSpread({},conv),{},{is_archived:false}):conv));showToast('Conversation unarchived!');}catch(error){showToast('Failed to unarchive conversation','error');}};const deleteArchivedConversation=async convId=>{try{await apiService.deleteConversation(convId);// Update local state\nsetPastConversations(prev=>prev.filter(conv=>conv.id!==convId));showToast('Conversation deleted!');}catch(error){showToast('Failed to delete conversation','error');}};const handleSubmit=async e=>{if(e)e.preventDefault();if(!input.trim()||isLoading||isGenerating)return;const messageText=input.trim();const messageFiles=uploadedFiles.length>0?[...uploadedFiles]:null;// Clear input immediately\nsetInput('');setUploadedFiles([]);setIsLoading(true);setIsGenerating(true);// Add user message to UI immediately\nconst userMessageId=Date.now().toString();const userMessage={id:userMessageId,role:'user',content:messageText,timestamp:new Date().toISOString(),reaction:null,isEdited:false,files:messageFiles};setMessages(prev=>[...prev,userMessage]);try{// Call backend API for real AI response\nconst response=await apiService.sendMessage(messageText,currentConversationId,messageFiles);if(response.success){// Update conversation ID if this was a new conversation\nif(!currentConversationId&&response.conversationId){setCurrentConversationId(response.conversationId);}// Add AI response to UI\nconst botResponseId=Date.now().toString();const botMessage={id:botResponseId,role:'assistant',content:response.aiResponse.content,timestamp:response.aiResponse.timestamp,reaction:null,isEdited:false,model:response.aiResponse.model};setMessages(prev=>[...prev,botMessage]);// Start typing animation\nsetTimeout(()=>{typeMessage(botResponseId,response.aiResponse.content);},100);showToast('Response generated successfully!');}else{throw new Error(response.error||'Failed to get AI response');}}catch(error){console.error(\"Failed to get AI response:\",error);// Add error response\nconst errorResponse={id:Date.now().toString(),role:'assistant',content:\"I apologize, but I'm having trouble connecting to our AI systems right now. Please try again in a moment, or reach out to your HR representative for immediate assistance.\",timestamp:new Date().toISOString(),reaction:null,isEdited:false};setMessages(prev=>[...prev,errorResponse]);showToast('Failed to get AI response. Please try again.','error');}finally{setIsLoading(false);setIsGenerating(false);setGenerationTimeoutId(null);setTypingMessageId(null);typingTimeoutIds.forEach(timeoutId=>clearTimeout(timeoutId));setTypingTimeoutIds([]);}};const handleKeyDown=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSubmit(e);}};const toggleVoiceMode=()=>{if(autoDetectLanguage){// Auto-detection mode\nif(!multiRecognitions.length){showToast('Speech recognition not supported in this browser','error');return;}if(isRecording){// Stop all recognition instances\nmultiRecognitions.forEach(rec=>{try{rec.stop();}catch(e){}});setIsRecording(false);showToast('Voice recording stopped');}else{try{setIsRecording(true);showToast('Auto-detecting language... Speak now','info');// Start all recognition instances\nmultiRecognitions.forEach(rec=>{try{rec.start();}catch(e){}});// Auto-stop after 10 seconds if no detection\nsetTimeout(()=>{if(isRecording){multiRecognitions.forEach(rec=>{try{rec.stop();}catch(e){}});setIsRecording(false);}},10000);}catch(error){console.error('Error starting speech recognition:',error);showToast('Failed to start voice recording','error');setIsRecording(false);}}}else{// Manual selection mode\nif(!recognition){showToast('Speech recognition not supported in this browser','error');return;}if(isRecording){recognition.stop();showToast('Voice recording stopped');}else{try{recognition.start();}catch(error){console.error('Error starting speech recognition:',error);showToast('Failed to start voice recording','error');}}}};const handleLanguageSelect=languageCode=>{setSpeechLanguage(languageCode);setShowLanguageSelector(false);const selectedLanguage=supportedLanguages.find(lang=>lang.code===languageCode);showToast(\"Speech language changed to \".concat((selectedLanguage===null||selectedLanguage===void 0?void 0:selectedLanguage.name)||languageCode));};const stopGeneration=()=>{if(generationTimeoutId){clearTimeout(generationTimeoutId);setGenerationTimeoutId(null);}typingTimeoutIds.forEach(timeoutId=>clearTimeout(timeoutId));setTypingTimeoutIds([]);setIsGenerating(false);setIsLoading(false);setTypingMessageId(null);showToast('Generation stopped','error');};const getInputButton=()=>{if(isGenerating||typingMessageId){return{icon:Square,onClick:stopGeneration,className:\"stop-button\",title:\"Stop generation\",disabled:false};}else if(input.trim()){return{icon:ArrowUp,onClick:e=>{e.preventDefault();handleSubmit();},className:\"send-button\",title:\"Send message\",disabled:isLoading||isGenerating||typingMessageId};}else{return{icon:isRecording?MicOff:Mic,onClick:toggleVoiceMode,className:\"voice-btn \".concat(isRecording?'recording':''),title:isRecording?\"Stop recording\":\"Start voice input\",disabled:isLoading||isGenerating||typingMessageId};}};const renderConversationItem=conv=>/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-item \".concat(currentConversationId===conv.id?'active':'',\" \").concat(conv.is_favourite?'favourite':''),onClick:()=>handleConversationClick(conv),children:[renamingConversationId===conv.id?/*#__PURE__*/_jsx(\"div\",{className:\"rename-input-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:renamingText,onChange:e=>setRenamingText(e.target.value),onKeyDown:e=>{if(e.key==='Enter')saveRename();if(e.key==='Escape')cancelRename();},onBlur:saveRename,autoFocus:true,className:\"rename-input\"})}):/*#__PURE__*/_jsx(\"span\",{className:\"conversation-text\",children:conv.title}),conv.is_favourite&&/*#__PURE__*/_jsx(Heart,{className:\"favourite-icon\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"dropdown-toggle\",onClick:e=>toggleDropdown(conv.id,e),title:\"More options\",children:/*#__PURE__*/_jsx(MoreHorizontal,{className:\"icon-sm\"})}),/*#__PURE__*/_jsx(ConversationDropdown,{conversation:conv,isOpen:openDropdownId===conv.id,onClose:closeDropdown,onFavourite:()=>toggleConversationFavourite(conv.id,{stopPropagation:()=>{}}),onArchive:()=>archiveConversation(conv.id,{stopPropagation:()=>{}}),onDelete:()=>deleteConversation(conv.id,{stopPropagation:()=>{}}),onRename:()=>startRenaming(conv.id)})]})]},conv.id);// If in test mode, show the database test component\n// Test mode removed - now using proper backend API architecture\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"app-container \".concat(isDarkMode?'dark':'light'),children:[showFileUpload&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowFileUpload(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content file-upload-modal\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Upload Files\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowFileUpload(false),className:\"modal-close\",children:/*#__PURE__*/_jsx(X,{className:\"icon\"})})]}),/*#__PURE__*/_jsx(FileUpload,{onFileSelect:handleFileSelect})]})}),toast&&/*#__PURE__*/_jsx(Toast,{message:toast.message,type:toast.type,onClose:()=>setToast(null)}),/*#__PURE__*/_jsx(ArchivedConversationsModal,{isOpen:showArchivedModal,onClose:()=>setShowArchivedModal(false),conversations:archivedConversations,onViewChat:viewArchivedChat,onUnarchive:unarchiveConversation,onDelete:deleteArchivedConversation}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar \".concat(isSidebarCollapsed?'collapsed':'',\" \").concat(isSidebarOpen?'open':'',\" \").concat(isSidebarHidden?'hidden':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-header\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:handleNewChat,className:\"new-chat-btn\",children:[/*#__PURE__*/_jsx(Plus,{className:\"icon\"}),!isSidebarCollapsed&&/*#__PURE__*/_jsx(\"span\",{children:\"New chat\"})]})}),!isSidebarCollapsed&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-wrapper \".concat(isSearchFocused?'focused':''),children:[/*#__PURE__*/_jsx(Search,{className:\"search-icon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search chats\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),onFocus:()=>setIsSearchFocused(true),onBlur:()=>setIsSearchFocused(false),className:\"search-input\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-filters\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"filter-btn \".concat(conversationFilter==='all'?'active':''),onClick:()=>setConversationFilter('all'),children:\"All\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filter-btn \".concat(conversationFilter==='favourites'?'active':''),onClick:()=>setConversationFilter('favourites'),children:\"Favourites\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"conversation-list\",children:conversationsLoading?/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px',textAlign:'center',color:'#666'},children:\"Loading conversations...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[conversationGroups.today.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"group-label\",children:\"Today\"}),conversationGroups.today.map(renderConversationItem)]}),conversationGroups.yesterday.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"group-label\",children:\"Yesterday\"}),conversationGroups.yesterday.map(renderConversationItem)]}),conversationGroups.lastWeek.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"group-label\",children:\"Previous 7 days\"}),conversationGroups.lastWeek.map(renderConversationItem)]}),conversationGroups.lastMonth.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"group-label\",children:\"Previous 30 days\"}),conversationGroups.lastMonth.map(renderConversationItem)]}),conversationGroups.older.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"group-label\",children:\"Older\"}),conversationGroups.older.map(renderConversationItem)]}),pastConversations.length===0&&!conversationsLoading&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',textAlign:'center',color:'#666',fontSize:'14px'},children:[\"No conversations yet.\",/*#__PURE__*/_jsx(\"br\",{}),\"Start a new chat to get started!\"]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-footer\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:toggleTheme,className:\"theme-toggle\",children:[isDarkMode?/*#__PURE__*/_jsx(Sun,{className:\"icon\"}):/*#__PURE__*/_jsx(Moon,{className:\"icon\"}),!isSidebarCollapsed&&/*#__PURE__*/_jsx(\"span\",{children:isDarkMode?'Light mode':'Dark mode'})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowArchivedModal(true),className:\"archive-toggle-btn\",children:[/*#__PURE__*/_jsx(Archive,{className:\"icon\"}),!isSidebarCollapsed&&/*#__PURE__*/_jsxs(\"span\",{children:[\"Archived (\",archivedConversations.length,\")\"]})]}),!isSidebarCollapsed&&/*#__PURE__*/_jsx(\"div\",{className:\"user-section\",children:/*#__PURE__*/_jsx(\"div\",{style:{padding:'10px',textAlign:'center',fontSize:'12px',color:'#666',borderTop:'1px solid #eee'},children:\"Single User Mode - No Login Required\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-content \".concat(isSidebarOpen?'sidebar-open':'',\" \").concat(isSidebarHidden?'sidebar-hidden':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:toggleSidebar,className:\"sidebar-toggle\",children:/*#__PURE__*/_jsx(Sidebar,{className:\"icon\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"chat-title\",children:currentConversationId?((_pastConversations$fi=pastConversations.find(c=>c.id===currentConversationId))===null||_pastConversations$fi===void 0?void 0:_pastConversations$fi.title)||'Chat':'Onboarding Assistant'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-container\",ref:chatContainerRef,children:messages.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-screen\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"welcome-icon\",children:/*#__PURE__*/_jsx(Bot,{size:48})}),/*#__PURE__*/_jsx(\"h1\",{className:\"welcome-title\",children:\"How can I help you today?\"}),/*#__PURE__*/_jsx(\"p\",{className:\"welcome-subtitle\",children:\"I'm your onboarding assistant. Ask me anything about company policies, benefits, procedures, or getting started at the company.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"suggestion-cards\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"suggestion-card\",onClick:()=>setInput(\"What are the company's vacation policies?\"),children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCC5 Vacation\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"suggestion-card\",onClick:()=>setInput(\"How do I set up my IT equipment?\"),children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCBB IT Setup\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"suggestion-card\",onClick:()=>setInput(\"What benefits do I have access to?\"),children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDFE5 Benefits\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"suggestion-card\",onClick:()=>setInput(\"Who are my team members?\"),children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC65 Team\"})})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"chat-messages\",children:[messages.map((msg,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"message \".concat(msg.role),children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-avatar\",children:msg.role==='user'?/*#__PURE__*/_jsx(\"div\",{className:\"avatar user-avatar-chat\",children:/*#__PURE__*/_jsx(User,{className:\"icon\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"avatar assistant-avatar\",children:/*#__PURE__*/_jsx(Bot,{className:\"icon\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"message-content\",children:editingMessageId===msg.id?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-container\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:editingText,onChange:e=>setEditingText(e.target.value),className:\"edit-textarea\",autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-actions\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:saveMessageEdit,className:\"edit-save\",children:[/*#__PURE__*/_jsx(Check,{className:\"icon-sm\"}),\" Save\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setEditingMessageId(null),className:\"edit-cancel\",children:[/*#__PURE__*/_jsx(X,{className:\"icon-sm\"}),\" Cancel\"]})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"message-text\",children:[msg.role==='assistant'&&displayedContent[msg.id]!==undefined?displayedContent[msg.id]:msg.content,typingMessageId===msg.id&&/*#__PURE__*/_jsx(\"span\",{className:\"typing-cursor\",children:\"|\"}),msg.isEdited&&/*#__PURE__*/_jsx(\"span\",{className:\"edited-indicator\",children:\"(edited)\"}),msg.reaction&&/*#__PURE__*/_jsx(\"span\",{className:\"reaction \".concat(msg.reaction),children:msg.reaction==='like'?'ðŸ‘':'ðŸ‘Ž'})]}),msg.files&&/*#__PURE__*/_jsx(\"div\",{className:\"message-files\",children:msg.files.map(file=>/*#__PURE__*/_jsxs(\"div\",{className:\"file-attachment\",children:[/*#__PURE__*/_jsx(FileText,{className:\"icon-sm\"}),/*#__PURE__*/_jsx(\"span\",{children:file.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"file-size\",children:[\"(\",(file.size/1024).toFixed(1),\" KB)\"]})]},file.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"message-meta\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-time\",children:new Date(msg.timestamp).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}),/*#__PURE__*/_jsx(MessageActions,{message:msg,onCopy:copyToClipboard,onEdit:handleMessageEdit,onReact:handleMessageReaction,onRegenerate:regenerateResponse})]})]})})]},msg.id||index)),isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"message assistant\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-avatar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"avatar assistant-avatar\",children:/*#__PURE__*/_jsx(Bot,{className:\"icon\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"message-content\",children:/*#__PURE__*/_jsx(SkeletonLoader,{})})]}),/*#__PURE__*/_jsx(\"div\",{ref:chatEndRef})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-container\",children:[showScrollToBottom&&/*#__PURE__*/_jsx(\"button\",{onClick:scrollToBottom,className:\"scroll-to-bottom \".concat(showScrollToBottom?'visible':''),title:\"Scroll to bottom\",children:/*#__PURE__*/_jsx(ArrowUp,{className:\"icon\",style:{transform:'rotate(180deg)'}})}),uploadedFiles.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"uploaded-files\",children:uploadedFiles.map(file=>/*#__PURE__*/_jsxs(\"div\",{className:\"uploaded-file\",children:[/*#__PURE__*/_jsx(FileText,{className:\"icon-sm\"}),/*#__PURE__*/_jsx(\"span\",{children:file.name}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFile(file.id),className:\"remove-file\",children:/*#__PURE__*/_jsx(X,{className:\"icon-sm\"})})]},file.id))}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-wrapper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-actions-left\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowFileUpload(true),className:\"file-btn\",title:\"Upload files\",children:/*#__PURE__*/_jsx(Paperclip,{className:\"icon\"})})}),/*#__PURE__*/_jsx(\"textarea\",{ref:inputRef,value:input,onChange:e=>setInput(e.target.value),onKeyDown:handleKeyDown,placeholder:isGenerating||typingMessageId?\"Generating response...\":\"Message ChatGPT...\",className:\"message-input\",rows:1,disabled:isGenerating||typingMessageId}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-actions-right\",children:[!input.trim()&&/*#__PURE__*/_jsxs(\"div\",{className:\"language-selector-container\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowLanguageSelector(!showLanguageSelector),className:\"language-toggle\",title:autoDetectLanguage?\"Auto-detecting language\":\"Select speech language\",children:autoDetectLanguage?'ðŸŒ':((_supportedLanguages$f=supportedLanguages.find(lang=>lang.code===speechLanguage))===null||_supportedLanguages$f===void 0?void 0:_supportedLanguages$f.flag)||'ðŸŒ'}),showLanguageSelector&&/*#__PURE__*/_jsxs(\"div\",{className:\"language-selector\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"language-mode-toggle\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setAutoDetectLanguage(!autoDetectLanguage),className:\"mode-toggle-btn \".concat(autoDetectLanguage?'active':''),children:\"\\uD83E\\uDD16 Auto-detect\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setAutoDetectLanguage(false),className:\"mode-toggle-btn \".concat(!autoDetectLanguage?'active':''),children:\"\\uD83C\\uDFAF Manual\"})]}),detectedLanguage&&autoDetectLanguage&&/*#__PURE__*/_jsxs(\"div\",{className:\"detected-language\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detected-label\",children:\"Last detected:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detected-flag\",children:(_supportedLanguages$f2=supportedLanguages.find(lang=>lang.code===detectedLanguage))===null||_supportedLanguages$f2===void 0?void 0:_supportedLanguages$f2.flag}),/*#__PURE__*/_jsx(\"span\",{className:\"detected-name\",children:(_supportedLanguages$f3=supportedLanguages.find(lang=>lang.code===detectedLanguage))===null||_supportedLanguages$f3===void 0?void 0:_supportedLanguages$f3.name})]}),!autoDetectLanguage&&/*#__PURE__*/_jsx(_Fragment,{children:supportedLanguages.map(language=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleLanguageSelect(language.code),className:\"language-option \".concat(speechLanguage===language.code?'active':''),title:language.name,children:[/*#__PURE__*/_jsx(\"span\",{className:\"language-flag\",children:language.flag}),/*#__PURE__*/_jsx(\"span\",{className:\"language-name\",children:language.name})]},language.code))})]})]}),(()=>{const buttonConfig=getInputButton();const IconComponent=buttonConfig.icon;return/*#__PURE__*/_jsx(\"button\",{type:buttonConfig.className===\"send-button\"?\"submit\":\"button\",onClick:buttonConfig.className===\"send-button\"?undefined:buttonConfig.onClick,disabled:buttonConfig.disabled,className:buttonConfig.className,title:buttonConfig.title,children:/*#__PURE__*/_jsx(IconComponent,{className:\"icon\"})});})()]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-footer\",children:/*#__PURE__*/_jsx(\"span\",{children:\"ChatGPT can make mistakes. Check important info.\"})})]})})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useMemo","Plus","ArrowUp","User","Bot","Sun","Moon","Edit3","Trash2","Search","Copy","Mic","MicOff","Heart","Archive","Sidebar","ThumbsUp","ThumbsDown","RotateCcw","X","Check","Upload","FileText","Paperclip","MoreHorizontal","Square","apiService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useLocalStorage","key","initialValue","storedValue","setStoredValue","item","window","localStorage","getItem","JSON","parse","error","setValue","value","setItem","stringify","console","FileUpload","_ref","onFileSelect","acceptedTypes","isDragging","setIsDragging","fileInputRef","handleDrop","e","preventDefault","files","Array","from","dataTransfer","handleDragOver","handleDragLeave","handleFileSelect","target","className","concat","onDrop","onDragOver","onDragLeave","onClick","_fileInputRef$current","current","click","children","ref","type","multiple","accept","onChange","style","display","ArchivedConversationsModal","_ref2","isOpen","onClose","conversations","onViewChat","onUnarchive","onDelete","stopPropagation","length","map","conv","title","Date","createdAt","toLocaleDateString","id","ConversationDropdown","_ref3","conversation","onFavourite","onArchive","onRename","isFavourite","SkeletonLoader","Toast","_ref4","message","MessageActions","_ref5","onCopy","onEdit","onReact","onRegenerate","content","role","App","_pastConversations$fi","_supportedLanguages$f","_supportedLanguages$f2","_supportedLanguages$f3","pastConversations","setPastConversations","conversationsLoading","setConversationsLoading","messages","setMessages","input","setInput","isLoading","setIsLoading","currentConversationId","setCurrentConversationId","isSidebarCollapsed","setIsSidebarCollapsed","isSidebarOpen","setIsSidebarOpen","isSidebarHidden","setIsSidebarHidden","isMobile","setIsMobile","innerWidth","isDarkMode","setIsDarkMode","searchQuery","setSearchQuery","isSearchFocused","setIsSearchFocused","isRecording","setIsRecording","recognition","setRecognition","multiRecognitions","setMultiRecognitions","speechLanguage","setSpeechLanguage","browserLang","navigator","language","supportedCodes","includes","showLanguageSelector","setShowLanguageSelector","autoDetectLanguage","setAutoDetectLanguage","detectedLanguage","setDetectedLanguage","toast","setToast","editingMessageId","setEditingMessageId","editingText","setEditingText","uploadedFiles","setUploadedFiles","showFileUpload","setShowFileUpload","showScrollToBottom","setShowScrollToBottom","typingMessageId","setTypingMessageId","displayedContent","setDisplayedContent","openDropdownId","setOpenDropdownId","renamingConversationId","setRenamingConversationId","renamingText","setRenamingText","showArchivedModal","setShowArchivedModal","conversationFilter","setConversationFilter","isGenerating","setIsGenerating","generationTimeoutId","setGenerationTimeoutId","typingTimeoutIds","setTypingTimeoutIds","loadConversations","response","getConversations","success","chatEndRef","inputRef","chatContainerRef","supportedLanguages","code","name","flag","filteredConversations","filtered","filter","is_archived","is_favourite","_conv$messages","toLowerCase","some","msg","sort","a","b","created_at","archivedConversations","archived","_conv$messages2","groupConversationsByDate","now","today","getFullYear","getMonth","getDate","yesterday","setDate","lastWeek","lastMonth","setMonth","groups","older","forEach","convDate","convDateOnly","getTime","push","conversationGroups","_chatEndRef$current","scrollIntoView","behavior","document","documentElement","setAttribute","handleResize","mobile","addEventListener","removeEventListener","handleClickOutside","event","closest","chatContainer","handleScroll","scrollTop","scrollHeight","clientHeight","isNearBottom","showToast","arguments","undefined","setTimeout","SpeechRecognition","webkitSpeechRecognition","primaryLanguages","recognitionInstances","langCode","recognitionInstance","continuous","interimResults","lang","onresult","finalTranscript","confidence","i","resultIndex","results","result","isFinal","transcript","rec","stop","detectedLang","find","prev","substring","onerror","onstart","selectedLanguage","onend","errorMessage","typeMessage","messageId","_objectSpread","currentIndex","typingSpeed","timeoutIds","typeChar","slice","timeoutId","regenerateResponse","messageIndex","findIndex","userMessageIndex","userMessage","messagesUpToUser","newContent","newBotResponseId","toString","botMessage","aiResponse","timestamp","reaction","isEdited","model","finalMessages","Error","handleNewChat","_inputRef$current","focus","handleConversationClick","toggleSidebar","toggleTheme","copyToClipboard","text","clipboard","writeText","then","newFiles","file","Math","random","size","removeFile","fileId","f","scrollToBottom","_chatEndRef$current2","handleMessageReaction","handleMessageEdit","saveMessageEdit","toggleConversationFavourite","convId","c","updateConversation","archiveConversation","deleteConversation","toggleDropdown","closeDropdown","startRenaming","saveRename","trim","cancelRename","viewArchivedChat","unarchiveConversation","deleteArchivedConversation","handleSubmit","messageText","messageFiles","userMessageId","toISOString","sendMessage","conversationId","botResponseId","errorResponse","clearTimeout","handleKeyDown","shiftKey","toggleVoiceMode","start","handleLanguageSelect","languageCode","stopGeneration","getInputButton","icon","disabled","renderConversationItem","onKeyDown","onBlur","autoFocus","placeholder","onFocus","padding","textAlign","color","fontSize","borderTop","index","toFixed","toLocaleTimeString","hour","minute","transform","onSubmit","rows","buttonConfig","IconComponent"],"sources":["/workspace/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport { \n  Plus, ArrowUp, User, Bot, Sun, Moon, \n  Edit3, Trash2, Search, Copy, Mic, MicOff, \n  Heart, Archive, Sidebar,\n  ThumbsUp, ThumbsDown, RotateCcw, X, Check, Upload, \n  FileText, Paperclip, MoreHorizontal, Square\n} from 'lucide-react';\nimport apiService from './services/apiService';\n\n// --- Custom Hooks ---\nconst useLocalStorage = (key, initialValue) => {\n  const [storedValue, setStoredValue] = useState(() => {\n    try {\n      const item = window.localStorage.getItem(key);\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      return initialValue;\n    }\n  });\n\n  const setValue = (value) => {\n    try {\n      setStoredValue(value);\n      window.localStorage.setItem(key, JSON.stringify(value));\n    } catch (error) {\n      console.error('Error saving to localStorage:', error);\n    }\n  };\n\n  return [storedValue, setValue];\n};\n\n\n\n\n\n// --- File Upload Component ---\nconst FileUpload = ({ onFileSelect, acceptedTypes = \".pdf,.docx,.txt,.csv,.json,.png,.jpg,.jpeg\" }) => {\n  const [isDragging, setIsDragging] = useState(false);\n  const fileInputRef = useRef(null);\n\n  const handleDrop = (e) => {\n    e.preventDefault();\n    setIsDragging(false);\n    const files = Array.from(e.dataTransfer.files);\n    onFileSelect(files);\n  };\n\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    setIsDragging(true);\n  };\n\n  const handleDragLeave = () => {\n    setIsDragging(false);\n  };\n\n  const handleFileSelect = (e) => {\n    const files = Array.from(e.target.files);\n    onFileSelect(files);\n  };\n\n  return (\n    <div\n      className={`file-upload-area ${isDragging ? 'dragging' : ''}`}\n      onDrop={handleDrop}\n      onDragOver={handleDragOver}\n      onDragLeave={handleDragLeave}\n      onClick={() => fileInputRef.current?.click()}\n    >\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        multiple\n        accept={acceptedTypes}\n        onChange={handleFileSelect}\n        style={{ display: 'none' }}\n      />\n      <Upload className=\"icon\" />\n      <div className=\"upload-text\">\n        <span className=\"upload-primary\">Drop files here or click to upload</span>\n        <span className=\"upload-secondary\">Supports PDF, DOCX, TXT, CSV, JSON, Images</span>\n      </div>\n    </div>\n  );\n};\n\n// --- Archived Conversations Modal ---\nconst ArchivedConversationsModal = ({ isOpen, onClose, conversations, onViewChat, onUnarchive, onDelete }) => {\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"modal-overlay\" onClick={onClose}>\n      <div className=\"modal-content archived-modal\" onClick={e => e.stopPropagation()}>\n        <div className=\"modal-header\">\n          <h2>Archived Chats</h2>\n          <button onClick={onClose} className=\"modal-close\">\n            <X className=\"icon\" />\n          </button>\n        </div>\n        <div className=\"archived-modal-content\">\n          {conversations.length === 0 ? (\n            <div className=\"empty-state\">\n              <Archive className=\"empty-icon\" />\n              <p>No archived conversations</p>\n              <span>Conversations you archive will appear here</span>\n            </div>\n          ) : (\n            <div className=\"archived-table\">\n              <div className=\"archived-table-header\">\n                <div className=\"archived-table-col-name\">Name</div>\n                <div className=\"archived-table-col-date\">Date created</div>\n                <div className=\"archived-table-col-actions\"></div>\n              </div>\n              <div className=\"archived-table-body\">\n                {conversations.map(conv => (\n                  <div key={conv.id} className=\"archived-table-row\">\n                    <div className=\"archived-table-col-name\">\n                      <button\n                        onClick={() => onViewChat(conv)}\n                        className=\"archived-chat-name\"\n                        title=\"Click to view conversation\"\n                      >\n                        {conv.title}\n                      </button>\n                    </div>\n                    <div className=\"archived-table-col-date\">\n                      {new Date(conv.createdAt).toLocaleDateString()}\n                    </div>\n                    <div className=\"archived-table-col-actions\">\n                      <button\n                        onClick={() => onUnarchive(conv.id)}\n                        className=\"archived-icon-btn\"\n                        title=\"Unarchive conversation\"\n                      >\n                        <Archive className=\"icon-sm\" />\n                      </button>\n                      <button\n                        onClick={() => onDelete(conv.id)}\n                        className=\"archived-icon-btn danger\"\n                        title=\"Delete conversation\"\n                      >\n                        <Trash2 className=\"icon-sm\" />\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// --- Conversation Dropdown Component ---\nconst ConversationDropdown = ({ conversation, isOpen, onClose, onFavourite, onArchive, onDelete, onRename }) => {\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"conversation-dropdown\">\n      <button\n        onClick={(e) => {\n          e.stopPropagation();\n          onRename();\n          onClose();\n        }}\n        className=\"dropdown-item\"\n      >\n        <Edit3 className=\"icon-sm\" />\n        <span>Rename</span>\n      </button>\n      <button\n        onClick={(e) => {\n          e.stopPropagation();\n          onFavourite();\n          onClose();\n        }}\n        className=\"dropdown-item\"\n      >\n        <Heart className=\"icon-sm\" />\n        <span>{conversation.isFavourite ? 'Remove from favourites' : 'Add to favourites'}</span>\n      </button>\n      <button\n        onClick={(e) => {\n          e.stopPropagation();\n          onArchive();\n          onClose();\n        }}\n        className=\"dropdown-item\"\n      >\n        <Archive className=\"icon-sm\" />\n        <span>Archive</span>\n      </button>\n      <button\n        onClick={(e) => {\n          e.stopPropagation();\n          onDelete();\n          onClose();\n        }}\n        className=\"dropdown-item danger\"\n      >\n        <Trash2 className=\"icon-sm\" />\n        <span>Delete</span>\n      </button>\n    </div>\n  );\n};\n\n// --- Utility Components ---\nconst SkeletonLoader = () => (\n  <div className=\"skeleton-container\">\n    <div className=\"skeleton skeleton-avatar\"></div>\n    <div className=\"skeleton-content\">\n      <div className=\"skeleton skeleton-line long\"></div>\n      <div className=\"skeleton skeleton-line medium\"></div>\n      <div className=\"skeleton skeleton-line short\"></div>\n    </div>\n  </div>\n);\n\nconst Toast = ({ message, type, onClose }) => (\n  <div className={`toast toast-${type}`}>\n    <span>{message}</span>\n    <button onClick={onClose} className=\"toast-close\">\n      <X className=\"icon-sm\" />\n    </button>\n  </div>\n);\n\nconst MessageActions = ({ message, onCopy, onEdit, onReact, onRegenerate }) => (\n  <div className=\"message-actions\">\n    <button className=\"action-btn\" onClick={() => onCopy(message.content)} title=\"Copy message\">\n      <Copy className=\"icon-sm\" />\n    </button>\n    {message.role === 'assistant' && (\n      <>\n        <button className=\"action-btn\" onClick={() => onReact(message.id, 'like')} title=\"Good response\">\n          <ThumbsUp className=\"icon-sm\" />\n        </button>\n        <button className=\"action-btn\" onClick={() => onReact(message.id, 'dislike')} title=\"Poor response\">\n          <ThumbsDown className=\"icon-sm\" />\n        </button>\n        <button className=\"action-btn\" onClick={() => onRegenerate(message.id)} title=\"Regenerate\">\n          <RotateCcw className=\"icon-sm\" />\n        </button>\n      </>\n    )}\n    {message.role === 'user' && (\n      <button className=\"action-btn\" onClick={() => onEdit(message.id)} title=\"Edit message\">\n        <Edit3 className=\"icon-sm\" />\n      </button>\n    )}\n  </div>\n);\n\n// --- Main App Component ---\nexport default function App() {\n  // --- State Management ---\n  const [pastConversations, setPastConversations] = useState([]);\n  const [conversationsLoading, setConversationsLoading] = useState(true);\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [currentConversationId, setCurrentConversationId] = useState(null);\n  const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(false);\n  const [isSidebarOpen, setIsSidebarOpen] = useState(false);\n  const [isSidebarHidden, setIsSidebarHidden] = useState(true);\n  const [isMobile, setIsMobile] = useState(window.innerWidth <= 768);\n  const [isDarkMode, setIsDarkMode] = useLocalStorage('darkMode', true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [isSearchFocused, setIsSearchFocused] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recognition, setRecognition] = useState(null);\n  const [multiRecognitions, setMultiRecognitions] = useState([]);\n  const [speechLanguage, setSpeechLanguage] = useState(() => {\n    // Try to match browser language with supported languages\n    const browserLang = navigator.language || 'en-US';\n    const supportedCodes = [\n      'en-US', 'en-GB', 'de-DE', 'fr-FR', 'es-ES', 'it-IT', \n      'pt-PT', 'nl-NL', 'ru-RU', 'ja-JP', 'ko-KR', 'zh-CN', 'ar-SA'\n    ];\n    return supportedCodes.includes(browserLang) ? browserLang : 'en-US';\n  });\n  const [showLanguageSelector, setShowLanguageSelector] = useState(false);\n  const [autoDetectLanguage, setAutoDetectLanguage] = useState(true);\n  const [detectedLanguage, setDetectedLanguage] = useState(null);\n  const [toast, setToast] = useState(null);\n  const [editingMessageId, setEditingMessageId] = useState(null);\n  const [editingText, setEditingText] = useState('');\n  const [uploadedFiles, setUploadedFiles] = useState([]);\n  const [showFileUpload, setShowFileUpload] = useState(false);\n  const [showScrollToBottom, setShowScrollToBottom] = useState(false);\n  const [typingMessageId, setTypingMessageId] = useState(null);\n  const [displayedContent, setDisplayedContent] = useState({});\n  const [openDropdownId, setOpenDropdownId] = useState(null);\n  const [renamingConversationId, setRenamingConversationId] = useState(null);\n  const [renamingText, setRenamingText] = useState('');\n  const [showArchivedModal, setShowArchivedModal] = useState(false);\n  const [conversationFilter, setConversationFilter] = useState('all');\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [generationTimeoutId, setGenerationTimeoutId] = useState(null);\n  const [typingTimeoutIds, setTypingTimeoutIds] = useState([]);\n\n  // Load conversations on app start\n  useEffect(() => {\n    const loadConversations = async () => {\n      try {\n        setConversationsLoading(true);\n        const response = await apiService.getConversations();\n        if (response.success) {\n          setPastConversations(response.conversations);\n        }\n      } catch (error) {\n        console.error('Failed to load conversations:', error);\n      } finally {\n        setConversationsLoading(false);\n      }\n    };\n\n    loadConversations();\n  }, []);\n\n\n\n  const chatEndRef = useRef(null);\n  const inputRef = useRef(null);\n  const chatContainerRef = useRef(null);\n\n  // Supported languages for speech recognition\n  const supportedLanguages = [\n    { code: 'en-US', name: 'English (US)', flag: 'ðŸ‡ºðŸ‡¸' },\n    { code: 'en-GB', name: 'English (UK)', flag: 'ðŸ‡¬ðŸ‡§' },\n    { code: 'de-DE', name: 'German', flag: 'ðŸ‡©ðŸ‡ª' },\n    { code: 'fr-FR', name: 'French', flag: 'ðŸ‡«ðŸ‡·' },\n    { code: 'es-ES', name: 'Spanish', flag: 'ðŸ‡ªðŸ‡¸' },\n    { code: 'it-IT', name: 'Italian', flag: 'ðŸ‡®ðŸ‡¹' },\n    { code: 'pt-PT', name: 'Portuguese', flag: 'ðŸ‡µðŸ‡¹' },\n    { code: 'nl-NL', name: 'Dutch', flag: 'ðŸ‡³ðŸ‡±' },\n    { code: 'ru-RU', name: 'Russian', flag: 'ðŸ‡·ðŸ‡º' },\n    { code: 'ja-JP', name: 'Japanese', flag: 'ðŸ‡¯ðŸ‡µ' },\n    { code: 'ko-KR', name: 'Korean', flag: 'ðŸ‡°ðŸ‡·' },\n    { code: 'zh-CN', name: 'Chinese (Simplified)', flag: 'ðŸ‡¨ðŸ‡³' },\n    { code: 'ar-SA', name: 'Arabic', flag: 'ðŸ‡¸ðŸ‡¦' }\n  ];\n\n  // --- Memoized Values ---\n  const filteredConversations = useMemo(() => {\n    let filtered = pastConversations.filter(conv => !conv.is_archived);\n    \n    if (conversationFilter === 'favourites') {\n      filtered = filtered.filter(conv => conv.is_favourite);\n    }\n    \n    if (searchQuery) {\n      filtered = filtered.filter(conv => \n        conv.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        conv.messages?.some(msg => msg.content.toLowerCase().includes(searchQuery.toLowerCase()))\n      );\n    }\n    \n    return filtered.sort((a, b) => {\n      if (a.is_favourite && !b.is_favourite) return -1;\n      if (!a.is_favourite && b.is_favourite) return 1;\n      return new Date(b.created_at) - new Date(a.created_at);\n    });\n  }, [pastConversations, searchQuery, conversationFilter]);\n\n  const archivedConversations = useMemo(() => {\n    let archived = pastConversations.filter(conv => conv.is_archived);\n    \n    if (searchQuery) {\n      archived = archived.filter(conv => \n        conv.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        conv.messages?.some(msg => msg.content.toLowerCase().includes(searchQuery.toLowerCase()))\n      );\n    }\n    \n    return archived.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));\n  }, [pastConversations, searchQuery]);\n\n  const groupConversationsByDate = (conversations) => {\n    const now = new Date();\n    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n    const yesterday = new Date(today);\n    yesterday.setDate(yesterday.getDate() - 1);\n    const lastWeek = new Date(today);\n    lastWeek.setDate(lastWeek.getDate() - 7);\n    const lastMonth = new Date(today);\n    lastMonth.setMonth(lastMonth.getMonth() - 1);\n\n    const groups = {\n      today: [],\n      yesterday: [],\n      lastWeek: [],\n      lastMonth: [],\n      older: []\n    };\n\n    conversations.forEach(conv => {\n      const convDate = new Date(conv.created_at);\n      const convDateOnly = new Date(convDate.getFullYear(), convDate.getMonth(), convDate.getDate());\n      \n      if (convDateOnly.getTime() === today.getTime()) {\n        groups.today.push(conv);\n      } else if (convDateOnly.getTime() === yesterday.getTime()) {\n        groups.yesterday.push(conv);\n      } else if (convDate >= lastWeek) {\n        groups.lastWeek.push(conv);\n      } else if (convDate >= lastMonth) {\n        groups.lastMonth.push(conv);\n      } else {\n        groups.older.push(conv);\n      }\n    });\n\n    return groups;\n  };\n\n  const conversationGroups = useMemo(() => groupConversationsByDate(filteredConversations), [filteredConversations]);\n\n  // --- Effects ---\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n  useEffect(() => {\n    document.documentElement.setAttribute('data-theme', isDarkMode ? 'dark' : 'light');\n  }, [isDarkMode]);\n\n  useEffect(() => {\n    const handleResize = () => {\n      const mobile = window.innerWidth <= 768;\n      setIsMobile(mobile);\n      \n      if (!mobile && isSidebarOpen) {\n        setIsSidebarOpen(false);\n      }\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, [isSidebarOpen]);\n\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (isMobile && isSidebarOpen && !event.target.closest('.sidebar') && !event.target.closest('.sidebar-toggle')) {\n        setIsSidebarOpen(false);\n      }\n      if (openDropdownId && !event.target.closest('.conversation-dropdown') && !event.target.closest('.dropdown-toggle')) {\n        setOpenDropdownId(null);\n      }\n      if (showLanguageSelector && !event.target.closest('.language-selector') && !event.target.closest('.language-toggle')) {\n        setShowLanguageSelector(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    document.addEventListener('touchstart', handleClickOutside);\n    \n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n      document.removeEventListener('touchstart', handleClickOutside);\n    };\n  }, [isMobile, isSidebarOpen, openDropdownId, showLanguageSelector]);\n\n  useEffect(() => {\n    const chatContainer = chatContainerRef.current;\n    if (!chatContainer) return;\n\n    const handleScroll = () => {\n      const { scrollTop, scrollHeight, clientHeight } = chatContainer;\n      const isNearBottom = scrollHeight - scrollTop - clientHeight < 100;\n      setShowScrollToBottom(!isNearBottom && messages.length > 0);\n    };\n\n    chatContainer.addEventListener('scroll', handleScroll);\n    return () => chatContainer.removeEventListener('scroll', handleScroll);\n  }, [messages.length]);\n\n  // --- Essential Callbacks ---\n  const showToast = useCallback((message, type = 'success') => {\n    setToast({ message, type });\n    setTimeout(() => setToast(null), 3000);\n  }, []);\n\n  // Initialize speech recognition\n  useEffect(() => {\n    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\n      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n      \n      if (autoDetectLanguage) {\n        // Create multiple recognition instances for auto-detection\n        const primaryLanguages = ['en-US', 'de-DE', 'fr-FR', 'es-ES', 'it-IT'];\n        const recognitionInstances = [];\n        \n        primaryLanguages.forEach(langCode => {\n          const recognitionInstance = new SpeechRecognition();\n          recognitionInstance.continuous = false;\n          recognitionInstance.interimResults = true;\n          recognitionInstance.lang = langCode;\n          \n          recognitionInstance.onresult = (event) => {\n            let finalTranscript = '';\n            let confidence = 0;\n            \n            for (let i = event.resultIndex; i < event.results.length; i++) {\n              const result = event.results[i];\n              if (result.isFinal) {\n                finalTranscript += result[0].transcript;\n                confidence = result[0].confidence || 0;\n              }\n            }\n            \n            if (finalTranscript && confidence > 0.7) {\n              // Stop all recognition instances\n              recognitionInstances.forEach(rec => {\n                try { rec.stop(); } catch (e) {}\n              });\n              \n              const detectedLang = supportedLanguages.find(lang => lang.code === langCode);\n              setDetectedLanguage(langCode);\n              setSpeechLanguage(langCode);\n              setInput(prev => prev + finalTranscript);\n              setIsRecording(false);\n              showToast(`Detected ${detectedLang?.name || langCode}: \"${finalTranscript.substring(0, 30)}...\"`, 'success');\n            }\n          };\n          \n          recognitionInstance.onerror = (event) => {\n            if (event.error !== 'aborted' && event.error !== 'no-speech') {\n              console.error(`Speech recognition error (${langCode}):`, event.error);\n            }\n          };\n          \n          recognitionInstances.push(recognitionInstance);\n        });\n        \n        setMultiRecognitions(recognitionInstances);\n      } else {\n        // Single language recognition (manual selection)\n        const recognitionInstance = new SpeechRecognition();\n        \n        recognitionInstance.continuous = false;\n        recognitionInstance.interimResults = true;\n        recognitionInstance.lang = speechLanguage;\n        \n        recognitionInstance.onstart = () => {\n          setIsRecording(true);\n          const selectedLanguage = supportedLanguages.find(lang => lang.code === speechLanguage);\n          showToast(`Listening in ${selectedLanguage?.name || speechLanguage}... Speak now`, 'info');\n        };\n        \n        recognitionInstance.onresult = (event) => {\n          let finalTranscript = '';\n          \n          for (let i = event.resultIndex; i < event.results.length; i++) {\n            const transcript = event.results[i][0].transcript;\n            if (event.results[i].isFinal) {\n              finalTranscript += transcript;\n            }\n          }\n          \n          if (finalTranscript) {\n            setInput(prev => prev + finalTranscript);\n          }\n        };\n        \n        recognitionInstance.onend = () => {\n          setIsRecording(false);\n        };\n        \n        recognitionInstance.onerror = (event) => {\n          console.error('Speech recognition error:', event.error);\n          setIsRecording(false);\n          \n          let errorMessage = 'Speech recognition error';\n          switch (event.error) {\n            case 'no-speech':\n              errorMessage = 'No speech detected. Try again.';\n              break;\n            case 'not-allowed':\n              errorMessage = 'Microphone access denied. Please allow microphone access.';\n              break;\n            case 'network':\n              errorMessage = 'Network error. Check your connection.';\n              break;\n            default:\n              errorMessage = `Speech recognition error: ${event.error}`;\n          }\n          showToast(errorMessage, 'error');\n        };\n        \n        setRecognition(recognitionInstance);\n      }\n    }\n  }, [showToast, speechLanguage, supportedLanguages, autoDetectLanguage]);\n\n  const typeMessage = useCallback((messageId, content) => {\n    setTypingMessageId(messageId);\n    setDisplayedContent(prev => ({ ...prev, [messageId]: '' }));\n    \n    let currentIndex = 0;\n    const typingSpeed = 8;\n    const timeoutIds = [];\n    \n    const typeChar = () => {\n      if (currentIndex < content.length) {\n        setDisplayedContent(prev => ({\n          ...prev,\n          [messageId]: content.slice(0, currentIndex + 1)\n        }));\n        currentIndex++;\n        const timeoutId = setTimeout(typeChar, typingSpeed);\n        timeoutIds.push(timeoutId);\n        setTypingTimeoutIds(prev => [...prev, timeoutId]);\n      } else {\n        setTypingMessageId(null);\n        setDisplayedContent(prev => ({ ...prev, [messageId]: content }));\n        setTypingTimeoutIds(prev => prev.filter(id => !timeoutIds.includes(id)));\n        setIsGenerating(false);\n      }\n    };\n    \n    typeChar();\n  }, []);\n\n  const regenerateResponse = useCallback(async (messageId) => {\n    const messageIndex = messages.findIndex(msg => msg.id === messageId);\n    if (messageIndex === -1 || messages[messageIndex].role !== 'assistant') return;\n    \n    let userMessageIndex = messageIndex - 1;\n    while (userMessageIndex >= 0 && messages[userMessageIndex].role !== 'user') {\n      userMessageIndex--;\n    }\n    \n    if (userMessageIndex === -1) return;\n    \n    const userMessage = messages[userMessageIndex];\n    const messagesUpToUser = messages.slice(0, messageIndex);\n    setMessages(messagesUpToUser);\n    \n    setDisplayedContent(prev => {\n      const newContent = { ...prev };\n      delete newContent[messageId];\n      return newContent;\n    });\n    \n    setIsLoading(true);\n    setIsGenerating(true);\n    showToast('Regenerating response...');\n\n    try {\n      // Call backend API to regenerate response\n      const response = await apiService.regenerateResponse(currentConversationId, userMessage.id);\n      \n      if (response.success) {\n        const newBotResponseId = Date.now().toString();\n        const botMessage = {\n          id: newBotResponseId,\n          role: 'assistant',\n          content: response.aiResponse.content,\n          timestamp: response.aiResponse.timestamp,\n          reaction: null,\n          isEdited: false,\n          model: response.aiResponse.model\n        };\n        \n        const finalMessages = [...messagesUpToUser, botMessage];\n        setMessages(finalMessages);\n        \n        setTimeout(() => {\n          typeMessage(newBotResponseId, response.aiResponse.content);\n        }, 100);\n        \n        showToast('Response regenerated successfully!');\n      } else {\n        throw new Error(response.error || 'Failed to regenerate response');\n      }\n\n    } catch (error) {\n      console.error(\"Failed to regenerate response:\", error);\n      showToast('Failed to regenerate response. Please try again.', 'error');\n    } finally {\n      setIsLoading(false);\n      setIsGenerating(false);\n      setGenerationTimeoutId(null);\n      setTypingMessageId(null);\n    }\n  }, [messages, currentConversationId, typeMessage, showToast]);\n\n  // --- Helper Functions ---\n  const handleNewChat = () => {\n    setMessages([]);\n    setCurrentConversationId(null);\n    setInput('');\n    setUploadedFiles([]);\n    inputRef.current?.focus();\n    if (isMobile) {\n      setIsSidebarOpen(false);\n    }\n  };\n\n\n\n  const handleConversationClick = (conversation) => {\n    if (conversation.is_archived) {\n      showToast('This conversation is archived. Unarchive it first to view.', 'error');\n      return;\n    }\n    setCurrentConversationId(conversation.id);\n    setMessages(conversation.messages || []);\n    if (isMobile) {\n      setIsSidebarOpen(false);\n    }\n  };\n\n  const toggleSidebar = () => {\n    if (isMobile) {\n      setIsSidebarOpen(!isSidebarOpen);\n      if (!isSidebarOpen) {\n        setIsSidebarHidden(false);\n      }\n    } else {\n      setIsSidebarHidden(!isSidebarHidden);\n      if (isSidebarHidden) {\n        setIsSidebarCollapsed(false);\n      }\n    }\n  };\n\n  const toggleTheme = () => {\n    setIsDarkMode(!isDarkMode);\n  };\n\n  const copyToClipboard = (text) => {\n    navigator.clipboard.writeText(text).then(() => {\n      showToast('Copied to clipboard!');\n    });\n  };\n\n  const handleFileSelect = (files) => {\n    const newFiles = files.map(file => ({\n      id: Date.now() + Math.random(),\n      name: file.name,\n      size: file.size,\n      type: file.type,\n      file: file\n    }));\n    setUploadedFiles(prev => [...prev, ...newFiles]);\n    setShowFileUpload(false);\n    showToast(`${files.length} file(s) uploaded successfully!`);\n  };\n\n  const removeFile = (fileId) => {\n    setUploadedFiles(prev => prev.filter(f => f.id !== fileId));\n  };\n\n  const scrollToBottom = () => {\n    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const handleMessageReaction = (messageId, reaction) => {\n    setMessages(prev => prev.map(msg => \n      msg.id === messageId \n        ? { ...msg, reaction: msg.reaction === reaction ? null : reaction }\n        : msg\n    ));\n    showToast(`Message ${reaction === 'like' ? 'liked' : 'disliked'}!`);\n  };\n\n  const handleMessageEdit = (messageId) => {\n    const message = messages.find(msg => msg.id === messageId);\n    if (message) {\n      setEditingMessageId(messageId);\n      setEditingText(message.content);\n    }\n  };\n\n  const saveMessageEdit = () => {\n    setMessages(prev => prev.map(msg => \n      msg.id === editingMessageId \n        ? { ...msg, content: editingText, isEdited: true }\n        : msg\n    ));\n    setEditingMessageId(null);\n    setEditingText('');\n    showToast('Message updated!');\n  };\n\n  const toggleConversationFavourite = async (convId, e) => {\n    e.stopPropagation();\n    try {\n      const conversation = pastConversations.find(c => c.id === convId);\n      await apiService.updateConversation(convId, { is_favourite: !conversation.is_favourite });\n      \n      // Update local state\n      setPastConversations(prev => prev.map(conv => \n        conv.id === convId \n          ? { ...conv, is_favourite: !conv.is_favourite }\n          : conv\n      ));\n      \n      showToast(conversation?.is_favourite ? 'Removed from favourites!' : 'Added to favourites!');\n    } catch (error) {\n      showToast('Failed to update favourite status', 'error');\n    }\n  };\n\n  const archiveConversation = async (convId, e) => {\n    e.stopPropagation();\n    try {\n      const conversation = pastConversations.find(c => c.id === convId);\n      await apiService.updateConversation(convId, { is_archived: !conversation.is_archived });\n      \n      // Update local state\n      setPastConversations(prev => prev.map(conv => \n        conv.id === convId \n          ? { ...conv, is_archived: !conv.is_archived }\n          : conv\n      ));\n      \n      if (currentConversationId === convId) {\n        handleNewChat();\n      }\n      showToast('Conversation archived!');\n    } catch (error) {\n      showToast('Failed to archive conversation', 'error');\n    }\n  };\n\n  const deleteConversation = async (convId, e) => {\n    e.stopPropagation();\n    try {\n      await apiService.deleteConversation(convId);\n      \n      // Update local state\n      setPastConversations(prev => prev.filter(conv => conv.id !== convId));\n      \n      if (currentConversationId === convId) {\n        handleNewChat();\n      }\n      showToast('Conversation deleted!');\n    } catch (error) {\n      showToast('Failed to delete conversation', 'error');\n    }\n  };\n\n  const toggleDropdown = (convId, e) => {\n    e.stopPropagation();\n    setOpenDropdownId(openDropdownId === convId ? null : convId);\n  };\n\n  const closeDropdown = () => {\n    setOpenDropdownId(null);\n  };\n\n  const startRenaming = (convId) => {\n    const conversation = pastConversations.find(c => c.id === convId);\n    if (conversation) {\n      setRenamingConversationId(convId);\n      setRenamingText(conversation.title);\n    }\n  };\n\n  const saveRename = async () => {\n    if (renamingText.trim()) {\n      try {\n        await apiService.updateConversation(renamingConversationId, { title: renamingText.trim() });\n        \n        // Update local state\n        setPastConversations(prev => prev.map(conv => \n          conv.id === renamingConversationId \n            ? { ...conv, title: renamingText.trim() }\n            : conv\n        ));\n        \n        showToast('Conversation renamed!');\n      } catch (error) {\n        showToast('Failed to rename conversation', 'error');\n      }\n    }\n    setRenamingConversationId(null);\n    setRenamingText('');\n  };\n\n  const cancelRename = () => {\n    setRenamingConversationId(null);\n    setRenamingText('');\n  };\n\n  const viewArchivedChat = (conversation) => {\n    setCurrentConversationId(conversation.id);\n    setMessages(conversation.messages || []);\n    setShowArchivedModal(false);\n    if (isMobile) {\n      setIsSidebarOpen(false);\n      setIsSidebarHidden(true);\n    }\n  };\n\n  const unarchiveConversation = async (convId) => {\n    try {\n      await apiService.updateConversation(convId, { is_archived: false });\n      \n      // Update local state\n      setPastConversations(prev => prev.map(conv => \n        conv.id === convId \n          ? { ...conv, is_archived: false }\n          : conv\n      ));\n      \n      showToast('Conversation unarchived!');\n    } catch (error) {\n      showToast('Failed to unarchive conversation', 'error');\n    }\n  };\n\n  const deleteArchivedConversation = async (convId) => {\n    try {\n      await apiService.deleteConversation(convId);\n      \n      // Update local state\n      setPastConversations(prev => prev.filter(conv => conv.id !== convId));\n      \n      showToast('Conversation deleted!');\n    } catch (error) {\n      showToast('Failed to delete conversation', 'error');\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    if (e) e.preventDefault();\n    if (!input.trim() || isLoading || isGenerating) return;\n\n    const messageText = input.trim();\n    const messageFiles = uploadedFiles.length > 0 ? [...uploadedFiles] : null;\n    \n    // Clear input immediately\n    setInput('');\n    setUploadedFiles([]);\n    setIsLoading(true);\n    setIsGenerating(true);\n\n    // Add user message to UI immediately\n    const userMessageId = Date.now().toString();\n    const userMessage = { \n      id: userMessageId,\n      role: 'user', \n      content: messageText, \n      timestamp: new Date().toISOString(),\n      reaction: null,\n      isEdited: false,\n      files: messageFiles\n    };\n    \n    setMessages(prev => [...prev, userMessage]);\n\n    try {\n      // Call backend API for real AI response\n      const response = await apiService.sendMessage(messageText, currentConversationId, messageFiles);\n      \n      if (response.success) {\n        // Update conversation ID if this was a new conversation\n        if (!currentConversationId && response.conversationId) {\n          setCurrentConversationId(response.conversationId);\n        }\n\n        // Add AI response to UI\n        const botResponseId = Date.now().toString();\n        const botMessage = {\n          id: botResponseId,\n          role: 'assistant',\n          content: response.aiResponse.content,\n          timestamp: response.aiResponse.timestamp,\n          reaction: null,\n          isEdited: false,\n          model: response.aiResponse.model\n        };\n\n        setMessages(prev => [...prev, botMessage]);\n        \n        // Start typing animation\n        setTimeout(() => {\n          typeMessage(botResponseId, response.aiResponse.content);\n        }, 100);\n\n        showToast('Response generated successfully!');\n      } else {\n        throw new Error(response.error || 'Failed to get AI response');\n      }\n\n    } catch (error) {\n      console.error(\"Failed to get AI response:\", error);\n      \n      // Add error response\n      const errorResponse = {\n        id: Date.now().toString(),\n        role: 'assistant',\n        content: \"I apologize, but I'm having trouble connecting to our AI systems right now. Please try again in a moment, or reach out to your HR representative for immediate assistance.\",\n        timestamp: new Date().toISOString(),\n        reaction: null,\n        isEdited: false\n      };\n      \n      setMessages(prev => [...prev, errorResponse]);\n      showToast('Failed to get AI response. Please try again.', 'error');\n      \n    } finally {\n      setIsLoading(false);\n      setIsGenerating(false);\n      setGenerationTimeoutId(null);\n      setTypingMessageId(null);\n      typingTimeoutIds.forEach(timeoutId => clearTimeout(timeoutId));\n      setTypingTimeoutIds([]);\n    }\n  };\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit(e);\n    }\n  };\n\n  const toggleVoiceMode = () => {\n    if (autoDetectLanguage) {\n      // Auto-detection mode\n      if (!multiRecognitions.length) {\n        showToast('Speech recognition not supported in this browser', 'error');\n        return;\n      }\n\n      if (isRecording) {\n        // Stop all recognition instances\n        multiRecognitions.forEach(rec => {\n          try { rec.stop(); } catch (e) {}\n        });\n        setIsRecording(false);\n        showToast('Voice recording stopped');\n      } else {\n        try {\n          setIsRecording(true);\n          showToast('Auto-detecting language... Speak now', 'info');\n          \n          // Start all recognition instances\n          multiRecognitions.forEach(rec => {\n            try { rec.start(); } catch (e) {}\n          });\n          \n          // Auto-stop after 10 seconds if no detection\n          setTimeout(() => {\n            if (isRecording) {\n              multiRecognitions.forEach(rec => {\n                try { rec.stop(); } catch (e) {}\n              });\n              setIsRecording(false);\n            }\n          }, 10000);\n        } catch (error) {\n          console.error('Error starting speech recognition:', error);\n          showToast('Failed to start voice recording', 'error');\n          setIsRecording(false);\n        }\n      }\n    } else {\n      // Manual selection mode\n      if (!recognition) {\n        showToast('Speech recognition not supported in this browser', 'error');\n        return;\n      }\n\n      if (isRecording) {\n        recognition.stop();\n        showToast('Voice recording stopped');\n      } else {\n        try {\n          recognition.start();\n        } catch (error) {\n          console.error('Error starting speech recognition:', error);\n          showToast('Failed to start voice recording', 'error');\n        }\n      }\n    }\n  };\n\n  const handleLanguageSelect = (languageCode) => {\n    setSpeechLanguage(languageCode);\n    setShowLanguageSelector(false);\n    const selectedLanguage = supportedLanguages.find(lang => lang.code === languageCode);\n    showToast(`Speech language changed to ${selectedLanguage?.name || languageCode}`);\n  };\n\n  const stopGeneration = () => {\n    if (generationTimeoutId) {\n      clearTimeout(generationTimeoutId);\n      setGenerationTimeoutId(null);\n    }\n    \n    typingTimeoutIds.forEach(timeoutId => clearTimeout(timeoutId));\n    setTypingTimeoutIds([]);\n    \n    setIsGenerating(false);\n    setIsLoading(false);\n    setTypingMessageId(null);\n    showToast('Generation stopped', 'error');\n  };\n\n  const getInputButton = () => {\n    if (isGenerating || typingMessageId) {\n      return {\n        icon: Square,\n        onClick: stopGeneration,\n        className: \"stop-button\",\n        title: \"Stop generation\",\n        disabled: false\n      };\n    } else if (input.trim()) {\n      return {\n        icon: ArrowUp,\n        onClick: (e) => {\n          e.preventDefault();\n          handleSubmit();\n        },\n        className: \"send-button\",\n        title: \"Send message\",\n        disabled: isLoading || isGenerating || typingMessageId\n      };\n    } else {\n      return {\n        icon: isRecording ? MicOff : Mic,\n        onClick: toggleVoiceMode,\n        className: `voice-btn ${isRecording ? 'recording' : ''}`,\n        title: isRecording ? \"Stop recording\" : \"Start voice input\",\n        disabled: isLoading || isGenerating || typingMessageId\n      };\n    }\n  };\n\n  const renderConversationItem = (conv) => (\n    <div \n      key={conv.id} \n      className={`conversation-item ${currentConversationId === conv.id ? 'active' : ''} ${conv.is_favourite ? 'favourite' : ''}`}\n      onClick={() => handleConversationClick(conv)}\n    >\n      {renamingConversationId === conv.id ? (\n        <div className=\"rename-input-container\">\n          <input\n            type=\"text\"\n            value={renamingText}\n            onChange={(e) => setRenamingText(e.target.value)}\n            onKeyDown={(e) => {\n              if (e.key === 'Enter') saveRename();\n              if (e.key === 'Escape') cancelRename();\n            }}\n            onBlur={saveRename}\n            autoFocus\n            className=\"rename-input\"\n          />\n        </div>\n      ) : (\n        <span className=\"conversation-text\">{conv.title}</span>\n      )}\n      {conv.is_favourite && <Heart className=\"favourite-icon\" />}\n      <div className=\"conversation-actions\">\n        <button \n          className=\"dropdown-toggle\"\n          onClick={(e) => toggleDropdown(conv.id, e)}\n          title=\"More options\"\n        >\n          <MoreHorizontal className=\"icon-sm\" />\n        </button>\n        <ConversationDropdown\n          conversation={conv}\n          isOpen={openDropdownId === conv.id}\n          onClose={closeDropdown}\n          onFavourite={() => toggleConversationFavourite(conv.id, { stopPropagation: () => {} })}\n          onArchive={() => archiveConversation(conv.id, { stopPropagation: () => {} })}\n          onDelete={() => deleteConversation(conv.id, { stopPropagation: () => {} })}\n          onRename={() => startRenaming(conv.id)}\n        />\n      </div>\n    </div>\n  );\n\n  // If in test mode, show the database test component\n  // Test mode removed - now using proper backend API architecture\n\n  return (\n    <div className={`app-container ${isDarkMode ? 'dark' : 'light'}`}>\n      {/* Test mode removed - using backend API */}\n      \n      {/* Database errors now handled by backend API */}\n\n      {showFileUpload && (\n        <div className=\"modal-overlay\" onClick={() => setShowFileUpload(false)}>\n          <div className=\"modal-content file-upload-modal\" onClick={e => e.stopPropagation()}>\n            <div className=\"modal-header\">\n              <h2>Upload Files</h2>\n              <button onClick={() => setShowFileUpload(false)} className=\"modal-close\">\n                <X className=\"icon\" />\n              </button>\n            </div>\n            <FileUpload onFileSelect={handleFileSelect} />\n          </div>\n        </div>\n      )}\n\n      {toast && (\n        <Toast\n          message={toast.message}\n          type={toast.type}\n          onClose={() => setToast(null)}\n        />\n      )}\n\n      <ArchivedConversationsModal\n        isOpen={showArchivedModal}\n        onClose={() => setShowArchivedModal(false)}\n        conversations={archivedConversations}\n        onViewChat={viewArchivedChat}\n        onUnarchive={unarchiveConversation}\n        onDelete={deleteArchivedConversation}\n      />\n\n      <div className={`sidebar ${isSidebarCollapsed ? 'collapsed' : ''} ${isSidebarOpen ? 'open' : ''} ${isSidebarHidden ? 'hidden' : ''}`}>\n        <div className=\"sidebar-header\">\n          <button onClick={handleNewChat} className=\"new-chat-btn\">\n            <Plus className=\"icon\" />\n            {!isSidebarCollapsed && <span>New chat</span>}\n          </button>\n        </div>\n        \n        {!isSidebarCollapsed && (\n          <>\n            <div className=\"search-container\">\n              <div className={`search-wrapper ${isSearchFocused ? 'focused' : ''}`}>\n                <Search className=\"search-icon\" />\n                <input\n                  type=\"text\"\n                  placeholder=\"Search chats\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  onFocus={() => setIsSearchFocused(true)}\n                  onBlur={() => setIsSearchFocused(false)}\n                  className=\"search-input\"\n                />\n              </div>\n            </div>\n\n            <div className=\"conversation-filters\">\n              <button\n                className={`filter-btn ${conversationFilter === 'all' ? 'active' : ''}`}\n                onClick={() => setConversationFilter('all')}\n              >\n                All\n              </button>\n              <button\n                className={`filter-btn ${conversationFilter === 'favourites' ? 'active' : ''}`}\n                onClick={() => setConversationFilter('favourites')}\n              >\n                Favourites\n              </button>\n            </div>\n\n            <div className=\"conversation-list\">\n              {conversationsLoading ? (\n                <div style={{ padding: '20px', textAlign: 'center', color: '#666' }}>\n                  Loading conversations...\n                </div>\n              ) : (\n                <>\n                  {conversationGroups.today.length > 0 && (\n                    <div className=\"conversation-group\">\n                      <div className=\"group-label\">Today</div>\n                      {conversationGroups.today.map(renderConversationItem)}\n                    </div>\n                  )}\n\n                  {conversationGroups.yesterday.length > 0 && (\n                    <div className=\"conversation-group\">\n                      <div className=\"group-label\">Yesterday</div>\n                      {conversationGroups.yesterday.map(renderConversationItem)}\n                    </div>\n                  )}\n\n                  {conversationGroups.lastWeek.length > 0 && (\n                    <div className=\"conversation-group\">\n                      <div className=\"group-label\">Previous 7 days</div>\n                      {conversationGroups.lastWeek.map(renderConversationItem)}\n                    </div>\n                  )}\n\n                  {conversationGroups.lastMonth.length > 0 && (\n                    <div className=\"conversation-group\">\n                      <div className=\"group-label\">Previous 30 days</div>\n                      {conversationGroups.lastMonth.map(renderConversationItem)}\n                    </div>\n                  )}\n\n                  {conversationGroups.older.length > 0 && (\n                    <div className=\"conversation-group\">\n                      <div className=\"group-label\">Older</div>\n                      {conversationGroups.older.map(renderConversationItem)}\n                    </div>\n                  )}\n                  \n                  {pastConversations.length === 0 && !conversationsLoading && (\n                    <div style={{ \n                      padding: '20px', \n                      textAlign: 'center', \n                      color: '#666',\n                      fontSize: '14px'\n                    }}>\n                      No conversations yet.<br />\n                      Start a new chat to get started!\n                    </div>\n                  )}\n                </>\n              )}\n            </div>\n          </>\n        )}\n        \n        <div className=\"sidebar-footer\">\n          <button onClick={toggleTheme} className=\"theme-toggle\">\n            {isDarkMode ? <Sun className=\"icon\" /> : <Moon className=\"icon\" />}\n            {!isSidebarCollapsed && <span>{isDarkMode ? 'Light mode' : 'Dark mode'}</span>}\n          </button>\n          \n          <button onClick={() => setShowArchivedModal(true)} className=\"archive-toggle-btn\">\n            <Archive className=\"icon\" />\n            {!isSidebarCollapsed && <span>Archived ({archivedConversations.length})</span>}\n          </button>\n          \n          {!isSidebarCollapsed && (\n            <div className=\"user-section\">\n              <div style={{ \n                padding: '10px', \n                textAlign: 'center', \n                fontSize: '12px', \n                color: '#666',\n                borderTop: '1px solid #eee'\n              }}>\n                Single User Mode - No Login Required\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className={`main-content ${isSidebarOpen ? 'sidebar-open' : ''} ${isSidebarHidden ? 'sidebar-hidden' : ''}`}>\n        <div className=\"chat-header\">\n          <button onClick={toggleSidebar} className=\"sidebar-toggle\">\n            <Sidebar className=\"icon\" />\n          </button>\n          <h1 className=\"chat-title\">\n            {currentConversationId \n              ? pastConversations.find(c => c.id === currentConversationId)?.title || 'Chat'\n              : 'Onboarding Assistant'\n            }\n          </h1>\n        </div>\n\n        <div className=\"chat-container\" ref={chatContainerRef}>\n          {messages.length === 0 ? (\n            <div className=\"welcome-screen\">\n              <div className=\"welcome-icon\">\n                <Bot size={48} />\n              </div>\n              <h1 className=\"welcome-title\">How can I help you today?</h1>\n              <p className=\"welcome-subtitle\">\n                I'm your onboarding assistant. Ask me anything about company policies, benefits, procedures, or getting started at the company.\n              </p>\n\n              <div className=\"suggestion-cards\">\n                <div className=\"suggestion-card\" onClick={() => setInput(\"What are the company's vacation policies?\")}>\n                  <span>ðŸ“… Vacation</span>\n                </div>\n                <div className=\"suggestion-card\" onClick={() => setInput(\"How do I set up my IT equipment?\")}>\n                  <span>ðŸ’» IT Setup</span>\n                </div>\n                <div className=\"suggestion-card\" onClick={() => setInput(\"What benefits do I have access to?\")}>\n                  <span>ðŸ¥ Benefits</span>\n                </div>\n                <div className=\"suggestion-card\" onClick={() => setInput(\"Who are my team members?\")}>\n                  <span>ðŸ‘¥ Team</span>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"chat-messages\">\n              {messages.map((msg, index) => (\n                <div key={msg.id || index} className={`message ${msg.role}`}>\n                  <div className=\"message-avatar\">\n                    {msg.role === 'user' ? (\n                      <div className=\"avatar user-avatar-chat\">\n                        <User className=\"icon\" />\n                      </div>\n                    ) : (\n                      <div className=\"avatar assistant-avatar\">\n                        <Bot className=\"icon\" />\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"message-content\">\n                    {editingMessageId === msg.id ? (\n                      <div className=\"edit-container\">\n                        <textarea\n                          value={editingText}\n                          onChange={(e) => setEditingText(e.target.value)}\n                          className=\"edit-textarea\"\n                          autoFocus\n                        />\n                        <div className=\"edit-actions\">\n                          <button onClick={saveMessageEdit} className=\"edit-save\">\n                            <Check className=\"icon-sm\" /> Save\n                          </button>\n                          <button onClick={() => setEditingMessageId(null)} className=\"edit-cancel\">\n                            <X className=\"icon-sm\" /> Cancel\n                          </button>\n                        </div>\n                      </div>\n                    ) : (\n                      <>\n                        <div className=\"message-text\">\n                          {msg.role === 'assistant' && displayedContent[msg.id] !== undefined\n                            ? displayedContent[msg.id]\n                            : msg.content}\n                          {typingMessageId === msg.id && (\n                            <span className=\"typing-cursor\">|</span>\n                          )}\n                          {msg.isEdited && <span className=\"edited-indicator\">(edited)</span>}\n                          {msg.reaction && (\n                            <span className={`reaction ${msg.reaction}`}>\n                              {msg.reaction === 'like' ? 'ðŸ‘' : 'ðŸ‘Ž'}\n                            </span>\n                          )}\n                        </div>\n                        \n                        {msg.files && (\n                          <div className=\"message-files\">\n                            {msg.files.map(file => (\n                              <div key={file.id} className=\"file-attachment\">\n                                <FileText className=\"icon-sm\" />\n                                <span>{file.name}</span>\n                                <span className=\"file-size\">({(file.size / 1024).toFixed(1)} KB)</span>\n                              </div>\n                            ))}\n                          </div>\n                        )}\n                        \n                        <div className=\"message-meta\">\n                          <div className=\"message-time\">\n                            {new Date(msg.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}\n                          </div>\n                          <MessageActions\n                            message={msg}\n                            onCopy={copyToClipboard}\n                            onEdit={handleMessageEdit}\n                            onReact={handleMessageReaction}\n                            onRegenerate={regenerateResponse}\n                          />\n                        </div>\n                      </>\n                    )}\n                  </div>\n                </div>\n              ))}\n              \n              {isLoading && (\n                <div className=\"message assistant\">\n                  <div className=\"message-avatar\">\n                    <div className=\"avatar assistant-avatar\">\n                      <Bot className=\"icon\" />\n                    </div>\n                  </div>\n                  <div className=\"message-content\">\n                    <SkeletonLoader />\n                  </div>\n                </div>\n              )}\n              \n              <div ref={chatEndRef} />\n            </div>\n          )}\n        </div>\n\n        <div className=\"input-section\">\n          <div className=\"input-container\">\n            {showScrollToBottom && (\n              <button \n                onClick={scrollToBottom}\n                className={`scroll-to-bottom ${showScrollToBottom ? 'visible' : ''}`}\n                title=\"Scroll to bottom\"\n              >\n                <ArrowUp className=\"icon\" style={{ transform: 'rotate(180deg)' }} />\n              </button>\n            )}\n            \n            {uploadedFiles.length > 0 && (\n              <div className=\"uploaded-files\">\n                {uploadedFiles.map(file => (\n                  <div key={file.id} className=\"uploaded-file\">\n                    <FileText className=\"icon-sm\" />\n                    <span>{file.name}</span>\n                    <button \n                      onClick={() => removeFile(file.id)}\n                      className=\"remove-file\"\n                    >\n                      <X className=\"icon-sm\" />\n                    </button>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit}>\n              <div className=\"input-wrapper\">\n                <div className=\"input-actions-left\">\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowFileUpload(true)}\n                    className=\"file-btn\"\n                    title=\"Upload files\"\n                  >\n                    <Paperclip className=\"icon\" />\n                  </button>\n                </div>\n                \n                <textarea\n                  ref={inputRef}\n                  value={input}\n                  onChange={e => setInput(e.target.value)}\n                  onKeyDown={handleKeyDown}\n                  placeholder={isGenerating || typingMessageId ? \"Generating response...\" : \"Message ChatGPT...\"}\n                  className=\"message-input\"\n                  rows={1}\n                  disabled={isGenerating || typingMessageId}\n                />\n                \n                <div className=\"input-actions-right\">\n                  {/* Language selector for speech recognition */}\n                  {!input.trim() && (\n                    <div className=\"language-selector-container\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setShowLanguageSelector(!showLanguageSelector)}\n                        className=\"language-toggle\"\n                        title={autoDetectLanguage ? \"Auto-detecting language\" : \"Select speech language\"}\n                      >\n                        {autoDetectLanguage ? 'ðŸŒ' : (supportedLanguages.find(lang => lang.code === speechLanguage)?.flag || 'ðŸŒ')}\n                      </button>\n                      \n                      {showLanguageSelector && (\n                        <div className=\"language-selector\">\n                          <div className=\"language-mode-toggle\">\n                            <button\n                              onClick={() => setAutoDetectLanguage(!autoDetectLanguage)}\n                              className={`mode-toggle-btn ${autoDetectLanguage ? 'active' : ''}`}\n                            >\n                              ðŸ¤– Auto-detect\n                            </button>\n                            <button\n                              onClick={() => setAutoDetectLanguage(false)}\n                              className={`mode-toggle-btn ${!autoDetectLanguage ? 'active' : ''}`}\n                            >\n                              ðŸŽ¯ Manual\n                            </button>\n                          </div>\n                          \n                          {detectedLanguage && autoDetectLanguage && (\n                            <div className=\"detected-language\">\n                              <span className=\"detected-label\">Last detected:</span>\n                              <span className=\"detected-flag\">\n                                {supportedLanguages.find(lang => lang.code === detectedLanguage)?.flag}\n                              </span>\n                              <span className=\"detected-name\">\n                                {supportedLanguages.find(lang => lang.code === detectedLanguage)?.name}\n                              </span>\n                            </div>\n                          )}\n                          \n                          {!autoDetectLanguage && (\n                            <>\n                              {supportedLanguages.map(language => (\n                                <button\n                                  key={language.code}\n                                  onClick={() => handleLanguageSelect(language.code)}\n                                  className={`language-option ${speechLanguage === language.code ? 'active' : ''}`}\n                                  title={language.name}\n                                >\n                                  <span className=\"language-flag\">{language.flag}</span>\n                                  <span className=\"language-name\">{language.name}</span>\n                                </button>\n                              ))}\n                            </>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  )}\n                  \n                  {(() => {\n                    const buttonConfig = getInputButton();\n                    const IconComponent = buttonConfig.icon;\n                    return (\n                      <button\n                        type={buttonConfig.className === \"send-button\" ? \"submit\" : \"button\"}\n                        onClick={buttonConfig.className === \"send-button\" ? undefined : buttonConfig.onClick}\n                        disabled={buttonConfig.disabled}\n                        className={buttonConfig.className}\n                        title={buttonConfig.title}\n                      >\n                        <IconComponent className=\"icon\" />\n                      </button>\n                    );\n                  })()}\n                </div>\n              </div>\n            </form>\n            <div className=\"input-footer\">\n              <span>ChatGPT can make mistakes. Check important info.</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}